<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Blog Atom Feed"><title data-react-helmet="true">The Surprisingly Happy Tale of Visual Studio Online, Continous Integration and Chutzpah | I CAN MAKE THIS WORK</title><meta data-react-helmet="true" property="og:title" content="The Surprisingly Happy Tale of Visual Studio Online, Continous Integration and Chutzpah | I CAN MAKE THIS WORK"><meta data-react-helmet="true" name="description" content="Going off piste"><meta data-react-helmet="true" property="og:description" content="Going off piste"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/styles.a755cef0.css">
<link rel="preload" href="/styles.c1706ff8.js" as="script">
<link rel="preload" href="/runtime~main.33bade23.js" as="script">
<link rel="preload" href="/main.97e26571.js" as="script">
<link rel="preload" href="/1.8880c22c.js" as="script">
<link rel="preload" href="/2.b9a20647.js" as="script">
<link rel="preload" href="/ccc49370.e990cfad.js" as="script">
<link rel="preload" href="/9d38daca.9ec7554d.js" as="script">
<link rel="preload" href="/159b6cb9.f413a5dc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/02/27/goodbye-client-affinity-hello-data-protection-with-azure">Goodbye Client Affinity, Hello Data Protection with Azure</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/02/16/easy-auth-tokens-survive-releases-on-linux-azure-app-service">Making Easy Auth tokens survive releases on Linux Azure App Service</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/02/11/azure-app-service-health-checks-and-zero-downtime-deployments">Azure App Service, Health checks and zero downtime deployments</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/02/08/arm-templates-security-role-assignments">ARM templates, security, role assignments and magic GUIDs</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/01/30/aspnet-serilog-and-application-insights">ASP.NET, Serilog and Application Insights</a></li></ul></div></div><main class="col col--8"><article><header><h1 class="margin-bottom--sm blogPostTitle_3-lP">The Surprisingly Happy Tale of Visual Studio Online, Continous Integration and Chutzpah</h1><div class="margin-vert--md"><time datetime="2014-03-17T00:00:00.000Z" class="blogPostDate_Ta7i">March 17, 2014  ¬∑ 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="going-off-piste"></a>Going off piste<a class="hash-link" href="#going-off-piste" title="Direct link to heading">#</a></h2><p> The post that follows is a slightly rambly affair which is pretty much my journal of the first steps of getting up and running with JavaScript unit testing. I will not claim that much of this blog is down to me. In fact in large part is me working my way through <a href="http://blogs.msdn.com/b/visualstudioalm/archive/2012/07/09/javascript-unit-tests-on-team-foundation-service-with-chutzpah.aspx" target="_blank" rel="noopener noreferrer">Mathew Aniyan&#x27;s excellent blog post on integrating Chutzpah with TFS</a>. But a few deviations from this post have made me think it worth keeping hold of this record for my benefit (if no-one else&#x27;s).</p><p>That&#x27;s the disclaimers out of the way now...</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="try-try-try-again"></a>...Try, try, try again...<a class="hash-link" href="#try-try-try-again" title="Direct link to heading">#</a></h2><p>Getting started with JavaScript unit testing has not been the breeze I‚Äôd expected. Frankly I‚Äôve found the docs out there not particularly helpful. But if at first you don&#x27;t succeed then try, try, try again.</p><p>So after a number of failed attempts I‚Äôm going to give it another go. <a href="http://www.hanselminutes.com/412/getting-started-with-javascript-unit-testing-with-jasmine-and-rushaine-mcbean" target="_blank" rel="noopener noreferrer">Rushaine McBean</a> says Jasmine is easiest so I&#x27;m going to follow her lead and give it a go.</p><p>Let‚Äôs new up a new (empty) ASP.NET project. Yes, I know ASP.NET has nothing to do with JavaScript unit testing but my end goal is to be able to run JS unit tests in Visual Studio and as part of Continuous Integration. Further to that, I&#x27;m anticipating a future where I have a solution that contains JavaScript unit tests and C# unit tests as well. It is indeed a bold and visionary Brave New World. We&#x27;ll see how far we get.</p><p>First up, download Jasmine from <a href="http://jasmine.github.io/" target="_blank" rel="noopener noreferrer">GitHub</a> - I&#x27;ll use <a href="https://github.com/pivotal/jasmine/blob/master/dist/jasmine-standalone-2.0.0.zip" target="_blank" rel="noopener noreferrer">v2.0</a>. Unzip it and fire up SpecRunner.html and whaddya know... It works!</p><p><a href="http://4.bp.blogspot.com/-M-Qct1e8Ofo/UxiT5wHICLI/AAAAAAAAAiY/tHUQemETCGI/s1600/LookItWorksRightOutTheBox.png" target="_blank" rel="noopener noreferrer"><img src="http://4.bp.blogspot.com/-M-Qct1e8Ofo/UxiT5wHICLI/AAAAAAAAAiY/tHUQemETCGI/s320/LookItWorksRightOutTheBox.png" alt="null"></a>As well it might. I‚Äôd be worried if it didn‚Äôt. So I‚Äôll move the contents of the release package into my empty project. Now let‚Äôs see if we can get those tests running inside Visual Studio. I‚Äôd heard of <a href="https://chutzpah.codeplex.com/" target="_blank" rel="noopener noreferrer">Chutzpah</a> which describes itself thusly:</p><blockquote><p><em>‚ÄúChutzpah is an open source JavaScript test runner which enables you to run unit tests using QUnit, Jasmine, Mocha, CoffeeScript and TypeScript.‚Äù </em></p></blockquote><p>What I‚Äôm after is the Chutzpah test adapter for Visual Studio 2012/2013 which can be found <a href="http://visualstudiogallery.msdn.microsoft.com/f8741f04-bae4-4900-81c7-7c9bfb9ed1fe" target="_blank" rel="noopener noreferrer">here</a>. I download the VSIX and install. Pretty painless. Once I restart Visual Studio I can see my unit tests in the test explorer. Nice! Run them and...</p><p><a href="http://2.bp.blogspot.com/-Ns9-ZoCzyxU/UxiVe83GQAI/AAAAAAAAAik/9rJiv7c3gOA/s1600/EverythingFails.png" target="_blank" rel="noopener noreferrer"><img src="http://2.bp.blogspot.com/-Ns9-ZoCzyxU/UxiVe83GQAI/AAAAAAAAAik/9rJiv7c3gOA/s320/EverythingFails.png" alt="null"></a>All fail. This makes me sad. All the errors say ‚ÄúCan‚Äôt find variable: Player in file‚Äù. Hmmm. Why? Dammit I‚Äôm actually going to have to read the <a href="https://chutzpah.codeplex.com/wikipage?title=Chutzpah%20File%20References&amp;referringTitle=Documentation" target="_blank" rel="noopener noreferrer">documentation</a>... It turns out the issue can be happily resolved by adding these 3 references to the top of PlayerSpec.js:</p><div class="mdxCodeBlock_1zKU">/// &lt;reference path=&quot;../src/Player.js&quot; /&gt; /// &lt;reference path=&quot;../src/Song.js&quot; /&gt; /// &lt;reference path=&quot;SpecHelper.js&quot; /&gt;</div><p>Now the tests pass:</p><p><a href="http://1.bp.blogspot.com/-n020yJN-tpA/UxiWLRegm5I/AAAAAAAAAis/TJHqYn08MZ4/s1600/EverythingPasses.png" target="_blank" rel="noopener noreferrer"><img src="http://1.bp.blogspot.com/-n020yJN-tpA/UxiWLRegm5I/AAAAAAAAAis/TJHqYn08MZ4/s320/EverythingPasses.png" alt="null"></a>The question is: can we get this working with Visual Studio Online?</p><p>Fortunately another has gone before me. Mathew Aniyan has written a <a href="http://blogs.msdn.com/b/visualstudioalm/archive/2012/07/09/javascript-unit-tests-on-team-foundation-service-with-chutzpah.aspx" target="_blank" rel="noopener noreferrer">superb blog post called &quot;Javascript Unit Tests on Team Foundation Service with Chutzpah&quot;</a>. Using this post as a guide (it was written 18 months ago which is frankly aeons in the world of the web) I&#x27;m hoping that I&#x27;ll be able to, without too many tweaks, get Javascript unit tests running on Team Foundation Service / Visual Studio Online ( / insert this weeks rebranding here).</p><p>First of all in Visual Studio Online I‚Äôll create a new project called &quot;GettingStartedWithJavaScriptUnitTesting&quot; (using all the default options). Apparently <em>‚ÄúYour project is created and your team is going to absolutely love this.‚Äù</em> Hmmmm... I think I‚Äôll be judge of that.</p><p>Let&#x27;s navigate to the project. I&#x27;ll fire up Visual Studio by clicking on the ‚ÄúOpen in Visual Studio‚Äù link. Once fired up and all the workspace mapping is sorted I‚Äôll move my project into the GettingStartedWithJavaScriptUnitTesting folder that now exists on my machine and add this to source control.</p><p>Back to Mathew&#x27;s blog. It suggests renaming Chutzpah.VS2012.vsix to Chutzpah.VS2012.zip and checking certain files into TFS. I think Chutzpah has changed a certain amount since this was written. To be on the safe side I‚Äôll create a new folder in the root of my project called Chutzpah.VS2012 and put the contents of Chutzpah.VS2012.zip in there and add it to TFS (being careful to ensure that no dll‚Äôs are excluded).</p><p>Then I&#x27;ll follow steps 3 and 4 from the blog post:</p><blockquote><p>*3. In Visual Studio, Open Team Explorer &amp; connect to Team Foundation Service. Bring up the Manage Build Controllers dialog. [Build ‚Äì&gt; Manage Build Controllers] Select Hosted Build Controller Click on Properties button to bring up the Build Controller Properties dialog.</p><p>4. Change Version Control Path to custom Assemblies to refer to the folder where you checked in the binaries in step 2.</p><ul><li></li></ul></blockquote><p>In step 5 the blog tells me to edit my build definition. Well I don‚Äôt have one in this new project so let‚Äôs click on ‚ÄúNew Build Definition‚Äù, create one and then follow step 5:</p><blockquote><p>*5. In Team Explorer, go to the Builds section and Edit your Build Definition which will run the javascript tests. Click on the Process tab Select the row named Automated Tests. Click on ‚Ä¶ button next to the value.</p><ul><li></li></ul></blockquote><p>Rather than following step 6 (which essentially nukes the running of any .NET tests you might have) I chose to add another row by clicking &quot;Add&quot;. In the dialog presented I changed the Test assembly specification to **\*.js and checked the &quot;Fail build on test failure&quot; checkbox.</p><p><a href="http://3.bp.blogspot.com/-4lbMIsT9jFQ/Ux3ATwBrPgI/AAAAAAAAAjY/4XSY0u0RpOE/s1600/AutomatedTests.png" target="_blank" rel="noopener noreferrer"><img src="http://3.bp.blogspot.com/-4lbMIsT9jFQ/Ux3ATwBrPgI/AAAAAAAAAjY/4XSY0u0RpOE/s320/AutomatedTests.png" alt="null"></a>Step 7 says:</p><blockquote><p>*7. Create your Web application in Visual Studio and add your Qunit or Jasmine unit tests to them. <u>Make sure that the js files (that contain the tests) are getting copied to the build output directory.</u></p><ul><li></li></ul></blockquote><p>The picture below step 7 suggests that you should be setting your test / spec files to have a <code>Copy to Output Directory</code> setting of <code>Copy always</code>. <strong>This did not work for me!!!</strong> Instead, setting a <code>Build Action</code> of <code>Content</code> and a <code>Copy to Output Directory</code> setting of <code>Do not copy</code> did work.</p><p>Finally I checked everything into source control and queued a build. I honestly did not expect this to work. It couldn‚Äôt be this easy could it? And...</p><p><a href="http://2.bp.blogspot.com/-gEDIyMV7M_g/Uxibt99tuwI/AAAAAAAAAi8/G4I6XQp0aN0/s1600/ItOnlyBlimminWellWorked.png" target="_blank" rel="noopener noreferrer"><img src="http://2.bp.blogspot.com/-gEDIyMV7M_g/Uxibt99tuwI/AAAAAAAAAi8/G4I6XQp0aN0/s320/ItOnlyBlimminWellWorked.png" alt="null"></a>Wow! It did! Here‚Äôs me cynically expecting some kind of ‚Äúpermission denied‚Äù error and it actually works! Brilliant! Look up in the cloud it says the same thing!</p><p><a href="http://2.bp.blogspot.com/-A67cTSkzIDg/Uxib6wVnaWI/AAAAAAAAAjE/ZwbUdBJmi0w/s1600/InTheCloudToo.png" target="_blank" rel="noopener noreferrer"><img src="http://2.bp.blogspot.com/-A67cTSkzIDg/Uxib6wVnaWI/AAAAAAAAAjE/ZwbUdBJmi0w/s320/InTheCloudToo.png" alt="null"></a>Fantastic!</p><p>I realise that I haven‚Äôt yet written a single JavaScript unit test of my own and so I‚Äôve still a way to go. What I have done is quietened those voices in my head that said ‚Äúthere‚Äôs not too much point having a unit test suite that isn‚Äôt plugged into continuous integration‚Äù. Although it&#x27;s not documented here I&#x27;m happy to be able to report that I have been able to follow the self-same instructions for Team Foundation Service / Visual Studio Online and get CI working with TFS 2012 on our build server as well.</p><p>Having got up and running off the back of other peoples hard work I best try and write some of my own tests now....</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/jasmine">Jasmine</a><a class="margin-horiz--sm" href="/tags/tfs">TFS</a><a class="margin-horiz--sm" href="/tags/unit-testing">unit testing</a><a class="margin-horiz--sm" href="/tags/javascript">javascript</a><a class="margin-horiz--sm" href="/tags/continuous-integration">Continuous Integration</a></div></footer></article><div><a href="https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/blog/2014-03-17-the-surprisingly-happy-tale-of-visual.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/2014/04/01/typescript-instance-methods"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">¬´ TypeScript this is what I want! (the unfortunate neglect of Instance Methods / callback functions)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/2014/03/11/knockout-globalize-valuenumber-binding"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Knockout + Globalize = valueNumber Binding Handler ¬ª</div></a></div></nav></div></main><div class="col col--2"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#going-off-piste" class="table-of-contents__link">Going off piste</a></li><li><a href="#try-try-try-again" class="table-of-contents__link">...Try, try, try again...</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.c1706ff8.js"></script>
<script src="/runtime~main.33bade23.js"></script>
<script src="/main.97e26571.js"></script>
<script src="/1.8880c22c.js"></script>
<script src="/2.b9a20647.js"></script>
<script src="/ccc49370.e990cfad.js"></script>
<script src="/9d38daca.9ec7554d.js"></script>
<script src="/159b6cb9.f413a5dc.js"></script>
</body>
</html>