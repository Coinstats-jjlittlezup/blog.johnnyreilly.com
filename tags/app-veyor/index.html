<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51754530-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Posts tagged &quot;appveyor&quot; | I CAN MAKE THIS WORK</title><meta data-react-helmet="true" property="og:title" content="Posts tagged &quot;appveyor&quot; | I CAN MAKE THIS WORK"><meta data-react-helmet="true" name="description" content="Blog | Tagged &quot;appveyor&quot;"><meta data-react-helmet="true" property="og:description" content="Blog | Tagged &quot;appveyor&quot;"><meta data-react-helmet="true" property="og:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" name="twitter:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://blog.johnnyreilly.com/tags/app-veyor"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_tags_posts"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blog.johnnyreilly.com/tags/app-veyor"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/app-veyor" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/app-veyor" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3ed665c6.css">
<link rel="preload" href="/assets/js/styles.043be7d3.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.49eec7a8.js" as="script">
<link rel="preload" href="/assets/js/main.2e9ef896.js" as="script">
<link rel="preload" href="/assets/js/1.61076fe0.js" as="script">
<link rel="preload" href="/assets/js/2.def6ba93.js" as="script">
<link rel="preload" href="/assets/js/6875c492.faaeecf0.js" as="script">
<link rel="preload" href="/assets/js/c3b5bd8c.21066782.js" as="script">
<link rel="preload" href="/assets/js/2fef477a.8815056e.js" as="script">
<link rel="preload" href="/assets/js/b35d8c4a.d856f726.js" as="script">
<link rel="preload" href="/assets/js/69a5cb2c.d7203c73.js" as="script">
<link rel="preload" href="/assets/js/a85279d2.e6d3c839.js" as="script">
<link rel="preload" href="/assets/js/476b20cf.42208473.js" as="script">
<link rel="preload" href="/assets/js/4ba49fc7.517e6e22.js" as="script">
<link rel="preload" href="/assets/js/90afdc47.47ec6f9b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a><a class="navbar__item navbar__link" href="/about">About</a><a class="navbar__item navbar__link" href="/blog-archive">Blog Archive</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/about">About</a></li><li class="menu__list-item"><a class="menu__link" href="/blog-archive">Blog Archive</a></li><li class="menu__list-item"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="menu__link">Twitter</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">Recent posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/03/17/rss-update-we-moved-to-docusaurus">RSS update; we moved to Docusaurus</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/03/15/from-blogger-to-docusaurus">From Blogger to Docusaurus</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/03/10/managed-identity-azure-sql-entity-framework">Managed Identity, Azure SQL and Entity Framework</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/03/06/generate-typescript-and-csharp-clients-with-nswag">Generate TypeScript and CSharp clients with NSwag based on an API</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/02/27/goodbye-client-affinity-hello-data-protection-with-azure">Goodbye Client Affinity, Hello Data Protection with Azure</a></li></ul></div></div><main class="col col--7"><h1>6 posts tagged with &quot;appveyor&quot;</h1><a href="/tags">View All Tags</a><div class="margin-vert--xl"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/2018/06/16/vsts-yaml-up">VSTS... YAML up!</a></h2><div class="margin-vert--md"><time datetime="2018-06-16T00:00:00.000Z" class="blogPostDate_fNvV">June 16, 2018 Â· 5 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>For the longest time I&#x27;ve been using the likes of <a href="https://travis-ci.org/" target="_blank" rel="noopener noreferrer">Travis</a> and <a href="https://www.appveyor.com/" target="_blank" rel="noopener noreferrer">AppVeyor</a> to build open source projects that I work on. They rock. I&#x27;ve also recently been dipping my toes back in the water of <a href="https://www.visualstudio.com/team-services/" target="_blank" rel="noopener noreferrer">Visual Studio Team Services</a>. VSTS offers a whole stack of stuff, but my own area of interest has been the Continuous Integration / Continuous Deployment offering.</p><p> Historically I have been underwhelmed by the CI proposition of Team Foundation Server / VSTS. It was difficult to debug, difficult to configure, difficult to understand. If it worked... Great! If it didn&#x27;t (and it often didn&#x27;t), you were toast. But things done changed! I don&#x27;t know when it happened, but VSTS is now super configurable. You add tasks / configure them, build and you&#x27;re done! It&#x27;s really nice.</p><p>However, there&#x27;s been something I&#x27;ve been missing from Travis, AppVeyor et al. Keeping my build script with my code. Travis has <code>.travis.yml</code>, AppVeyor has <code>appveyor.yml</code>. VSTS, what&#x27;s up?</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-new-dawn"></a>The New Dawn<a class="hash-link" href="#the-new-dawn" title="Direct link to heading">#</a></h2><p>Up until now, really not much. It just wasn&#x27;t possible. Until it was:</p><blockquote><p>If you prefer a build definition in YAML then weâ€™re currently hard at work on that. You can enable it as a preview feature: <a href="https://t.co/hau9Sv8brf" target="_blank" rel="noopener noreferrer">https://t.co/hau9Sv8brf</a></p><p>â€” Martin Woodward (@martinwoodward) <a href="https://twitter.com/martinwoodward/status/970250739510534144?ref_src=twsrc%5Etfw" target="_blank" rel="noopener noreferrer">March 4, 2018</a></p></blockquote><script src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p>When I started testing it out I found things to like and some things I didn&#x27;t understand. Crucially, my CI now builds based upon <code>.vsts-ci.yml</code>. YAML baby!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="it-begins"></a>It Begins!<a class="hash-link" href="#it-begins" title="Direct link to heading">#</a></h2><p>You can get to &quot;Hello World&quot; by looking at <a href="https://docs.microsoft.com/en-us/vsts/pipelines/build/yaml?view=vsts" target="_blank" rel="noopener noreferrer">the docs here</a> and <a href="https://github.com/Microsoft/vsts-agent/blob/master/docs/preview/yamlgettingstarted.md" target="_blank" rel="noopener noreferrer">the examples here</a>. But what you really want is your existing build, configured in the UI, exported to YAML. That doesn&#x27;t seem to quite exist, but there&#x27;s something that gets you part way. Take a look:</p><p><img src="https://1.bp.blogspot.com/-DvGnGLL98Lc/WyVPlzFXozI/AAAAAAAAK1Y/ukRhpwRcRWckQI6QhrEjmmvCuhkYCxItACLcBGAs/s640/Screenshot%2B2018-06-16%2B18.49.08.png"></p><p>If you notice, in the top right of the screen, each task now allows you click on a new &quot;View YAML&quot; button. It&#x27;s kinda <a href="https://en.wikipedia.org/wiki/Ronseal" target="_blank" rel="noopener noreferrer">Ronseal</a>:</p><p><img src="https://2.bp.blogspot.com/-fiYHNC0ASSk/WyVR7qvx8FI/AAAAAAAAK1k/1cSeQXhyGVYPxOtICiqQnQdGImKQuZQMQCPcBGAYYCw/s400/Screenshot%2B2018-06-16%2B19.04.00.png"></p><p>Using this hotness you can build yourself a <code>.vsts-ci.yml</code> file task by task.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="a-bump-in-the-road"></a>A Bump in the Road<a class="hash-link" href="#a-bump-in-the-road" title="Direct link to heading">#</a></h2><p>If you look closely at the message above you&#x27;ll see there&#x27;s a message about an undefined variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yml"><div tabindex="0" class="prism-code language-yml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#Your build definition references an undefined variable named â€˜Parameters.RestoreBuildProjectsâ€™. Create or edit the build definition for this YAML file, define the variable on the Variables tab. See https://go.microsoft.com/fwlink/?linkid=865972</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> DotNetCoreCLI@2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">displayName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Restore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> restore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">projects</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;$(Parameters.RestoreBuildProjects)&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Try as I might, I couldn&#x27;t locate <code>Parameters.RestoreBuildProjects</code>. So no working CI build for me. Then I remembered <a href="https://github.com/zerdos" target="_blank" rel="noopener noreferrer">Zoltan Erdos</a>. He&#x27;s hard to forget. Or rather, I remembered an idea of his which I will summarise thusly: &quot;Have a <code>package.json</code> in the root of your repo, use the <code>scripts</code> for individual tasks and you have a cross platform task runner&quot;.</p><p>This is a powerful idea and one I decided to put to work. My project is React and TypeScript on the front end, and ASP.Net Core on the back. I wanted a <code>package.json</code> in the root of the repo which I could install dependencies, build, test and publish my whole app. I could call into that from my <code>.vsts-ci.yml</code> file. Something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my-amazing-project&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;author&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;John Reilly &lt;johnny_reilly@hotmail.com&gt;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;license&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MIT&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;private&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;scripts&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;preinstall&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;yarn run install:clientapp &amp;&amp; yarn run install:web&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;install:clientapp&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cd MyAmazingProject.ClientApp &amp;&amp; yarn install&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;install:web&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;dotnet restore&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;prebuild&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;yarn install&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;build&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;yarn run build:clientapp &amp;&amp; yarn run build:web&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;build:clientapp&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cd MyAmazingProject.ClientApp &amp;&amp; yarn run build&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;build:web&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;dotnet build --configuration Release&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;postbuild&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;yarn test&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;test&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;yarn run test:clientapp &amp;&amp; yarn run test:web&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;test:clientapp&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cd MyAmazingProject.ClientApp &amp;&amp; yarn test&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;test:web&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cd MyAmazingProject.Web.Tests &amp;&amp; dotnet test&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;publish:web&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cd MyAmazingProject.Web &amp;&amp; dotnet publish MyAmazingProject.Web.csproj --configuration Release&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/johnny_reilly@hotmail.com&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>It doesn&#x27;t matter if I have &quot;an undefined variable named â€˜Parameters.RestoreBuildProjectsâ€™&quot;. I now have no need to use all the individual tasks in a build. I can convert them into a couple of scripts in my <code>package.json</code>. So here&#x27;s where I&#x27;ve ended up for now. I&#x27;ve a <code>.vsts-ci.yml</code> file which looks like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yml"><div tabindex="0" class="prism-code language-yml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">queue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Hosted VS2017</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> geeklearningio.gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">vsts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">tasks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">yarn.yarn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">installer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">task.YarnInstaller@2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">displayName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> install yarn itself</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">checkLatest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> geeklearningio.gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">vsts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">tasks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">yarn.yarn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">task.Yarn@2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">displayName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> yarn build and test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">Arguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> geeklearningio.gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">vsts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">tasks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">yarn.yarn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">task.Yarn@2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">displayName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> yarn publish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">web</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">Arguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;run publish:web --output $(build.artifactstagingdirectory)/MyAmazingProject&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> PublishBuildArtifacts@1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">displayName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> publish build artifact</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">PathtoPublish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;$(build.artifactstagingdirectory)&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This file does the following:</p><ol><li>Installs yarn. (By the way VSTS, what&#x27;s with not having yarn installed by default? I&#x27;ll say this for the avoidance of doubt: in the npm cli space: yarn has won.)</li><li>Install our dependencies, build the front end and back end, run all the tests. Effectively <code>yarn build</code>.</li><li>Publish our web app to a directory. Effectively <code>yarn run publish:web</code>. This is only separate because we want to pass in the output directory and so it&#x27;s just easier for it to be a separate step.</li><li>Publish the build artefact to TFS. (This will go on to be picked up by the continuous deployment mechanism and published out to Azure.)</li></ol><p>I much prefer this to what I had before. I feel there&#x27;s much more that can be done here as well. I&#x27;m looking forward to the continuous deployment piece becoming scriptable too.</p><p>Thanks to Zoltan and props to the TFVS team!</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/yaml">yaml</a><a class="margin-horiz--sm" href="/tags/vsts">vsts</a><a class="margin-horiz--sm" href="/tags/ci">ci</a><a class="margin-horiz--sm" href="/tags/travis">travis</a><a class="margin-horiz--sm" href="/tags/app-veyor">AppVeyor</a></div><div class="col text--right"><a aria-label="Read more about VSTS... YAML up!" href="/2018/06/16/vsts-yaml-up"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/2017/04/25/setting-build-version-using-appveyor">Setting Build Version Using AppVeyor and ASP.Net Core</a></h2><div class="margin-vert--md"><time datetime="2017-04-25T00:00:00.000Z" class="blogPostDate_fNvV">April 25, 2017 Â· 2 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>AppVeyor has <a href="https://www.appveyor.com/docs/build-configuration/#assemblyinfo-patching" target="_blank" rel="noopener noreferrer">support for setting the version of a binary during a build</a>. However - this deals with the classic ASP.Net world of <code>AssemblyInfo</code>. I didn&#x27;t find any reference to support for doing the same with dot net core. Remember, dot net core <a href="https://docs.microsoft.com/en-us/dotnet/articles/core/tools/project-json-to-csproj#version" target="_blank" rel="noopener noreferrer">relies upon a <code>&amp;lt;Version&amp;gt;</code> or a <code>&amp;lt;VersionPrefix&amp;gt;</code> setting in the <code>.csproj</code> file</a>. Personally, <code>&amp;lt;Version&amp;gt;</code> is my jam.</p><p> However, coming up with your own bit of powershell that stamps the version during the build is a doddle; here we go:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ps"><div tabindex="0" class="prism-code language-ps codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Param($projectFile, $buildNum)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$content = [IO.File]::ReadAllText($projectFile)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$regex = new-object System.Text.RegularExpressions.Regex (&#x27;(&lt;version&gt;)([\d]+.[\d]+.[\d]+)(.[\d]+)(&lt;\/Version&gt;)&#x27;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         [System.Text.RegularExpressions.RegexOptions]::MultiLine)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$version = $null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$match = $regex.Match($content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if($match.Success) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # from &quot;&lt;version&gt;1.0.0.0&lt;/version&gt;&quot; this will extract &quot;1.0.0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $version = $match.groups[2].value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># suffix build number onto $version. eg &quot;1.0.0.15&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$version = &quot;$version.$buildNum&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># update &quot;&lt;version&gt;1.0.0.0&lt;/version&gt;&quot; to &quot;&lt;version&gt;$version&lt;/version&gt;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$content = $regex.Replace($content, &#x27;${1}&#x27; + $version + &#x27;${4}&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># update csproj file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[IO.File]::WriteAllText($projectFile, $content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># update AppVeyor build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Update-AppveyorBuild -Version $version</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/version&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You can invoke this script as part of the build process in AppVeyor by adding something like this to your <code>appveyor.yml</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yml"><div tabindex="0" class="prism-code language-yml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">before_build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">ps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> .\ModifyVersion.ps1 $env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">APPVEYOR_BUILD_FOLDER\src\Proverb.Web\Proverb.Web.csproj $env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">APPVEYOR_BUILD_NUMBER</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>It will keep the first 3 parts of the version in your <code>.csproj</code> (eg &quot;1.0.0&quot;) and suffix on the build number supplied by AppVeyor.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/powershell">powershell</a><a class="margin-horiz--sm" href="/tags/version">Version</a><a class="margin-horiz--sm" href="/tags/dot-net-core">dot net core</a><a class="margin-horiz--sm" href="/tags/app-veyor">AppVeyor</a></div><div class="col text--right"><a aria-label="Read more about Setting Build Version Using AppVeyor and ASP.Net Core" href="/2017/04/25/setting-build-version-using-appveyor"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/2015/02/11/the-convent-with-continuous-delivery">The Convent with Continuous Delivery</a></h2><div class="margin-vert--md"><time datetime="2015-02-11T00:00:00.000Z" class="blogPostDate_fNvV">February 11, 2015 Â· 4 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>I&#x27;ve done it. I&#x27;ve open sourced the <a href="http://www.poorclaresarundel.org/" target="_blank" rel="noopener noreferrer">website that I maintain for my aunt what is a nun</a>. Because I think we can all agree that nuns need open source and continuous integration about as much as anyone else.</p><p> For a long time now I&#x27;ve been maintaining a website for one of my (many) aunts that is a Poor Clare. (<a href="https://en.wikipedia.org/wiki/Subtyping" target="_blank" rel="noopener noreferrer">That&#x27;s a subtype of &quot;nun&quot; you OO enthusiasts.</a>) It&#x27;s not a terribly exciting site - it&#x27;s mostly static content. It&#x27;s built with a combination of AngularJS / TypeScript / Bootstrap and ASP.Net MVC. It&#x27;s hosted on <a href="http://azure.microsoft.com/en-us/documentation/services/websites/" target="_blank" rel="noopener noreferrer">Azure Websites</a>. In fact I have written about it (slightly more cagily) before <a href="https://blog.johnnyreilly.com/2014/06/migrating-from-angularjs-to-angularts.html" target="_blank" rel="noopener noreferrer">here</a>.</p><p>I&#x27;ll say up front: presentation-wise the site is not a work of art. However the nuns seem pretty happy with it. (Or perhaps secretly they&#x27;re forgiving me the shonkiness and sparing my feelings - who can say?) If I put my mind to it the site could look much more lovely. But there&#x27;s only so much time I can spare - and that&#x27;s actually one of the reasons I&#x27;ve set up Continuous Delivery.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="why-on-earth-did-you-bother"></a>Why on earth did you bother?<a class="hash-link" href="#why-on-earth-did-you-bother" title="Direct link to heading">#</a></h2><p>Well, you&#x27;d be surprised how often tweaks can be requested. Sometimes it appears to be forgotten for months at a time, and then all of a sudden my inbox is daily filled with a list of minor alterations. You know, slight text changes and the like.</p><p>So what I was generally doing was getting home of an evening, waiting until the children were in bed, chomping down some food and then firing up Visual Studio to make the changes and hit &quot;Publish&quot;. Yes that&#x27;s right; I was essentially using Visual Studio to edit text files and push a website out to Azure. The very definition of using a sledgehammer to crack a nut I think we can all agree.</p><p>It occurred to me that if I had Continuous Delivery set up then I could make these tweaks and not have to worry about the site being published. Which would be nice. I wouldn&#x27;t need Visual Studio anymore - any text editor would do. Also nice. Finally, if the source control was accessible online then I could probably get away with doing most tweaks on my mobile phone whilst I was travelling home. Timesaver!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-did-you-go-about-it"></a>How did you go about it?<a class="hash-link" href="#how-did-you-go-about-it" title="Direct link to heading">#</a></h2><p>Since <a href="http://www.visualstudioonline.com" target="_blank" rel="noopener noreferrer">Visual Studio Online (then &quot;Team Foundation Service&quot;)</a> was released I have been using it to host the source code. So the obvious solution was to use the tools offered there to do the deployment. However, this wasn&#x27;t the smooth experience you might have hoped for. I had quite a frustrating afternoon trying things out before deciding it was becoming more trouble than it was worth. VSO appeared to make it supremely hard to customise builds.</p><p>Just recently though I have been having the most wonderful experience with <a href="http://www.appveyor.com/" target="_blank" rel="noopener noreferrer">AppVeyor</a>. AppVeyor market themselves as <em>&quot;#1 Continuous Delivery service for Windows&quot;</em> - I think they&#x27;re right. Their build process is entirely flexible and customisable. It is, in short, a joy to use. (The support is fantastic too - very helpful indeed. Go <a href="https://github.com/FeodorFitsner" target="_blank" rel="noopener noreferrer">Feodor</a>!)</p><p>If you look just below the header you&#x27;ll read a very important sentence: <em>&quot;Free for open-source projects&quot;</em>. You hear that? By the time I&#x27;d finished reading that sentence I&#x27;d decided that the Poor Clares website was about to become an open source project.</p><p>And now it is.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="where-is-it"></a>Where is it?<a class="hash-link" href="#where-is-it" title="Direct link to heading">#</a></h2><p>The source on <a href="https://github.com/johnnyreilly/poorclaresarundel" target="_blank" rel="noopener noreferrer">GitHub</a>. The builds and deployment are taken care of by <a href="https://ci.appveyor.com/project/JohnReilly/poorclaresarundel" target="_blank" rel="noopener noreferrer">AppVeyor</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="will-you-take-pull-requests"></a>Will you take pull requests?<a class="hash-link" href="#will-you-take-pull-requests" title="Direct link to heading">#</a></h2><p>If they&#x27;re serious, then yes, certainly! My long term plan is to try and get the nuns set up as collaborators in GitHub. That way they can make their own minor tweaks without me getting involved.</p><p>On another front, I do wonder if open-sourcing Poor Clares, Arundel might have other hidden benefits. There&#x27;s a number of things I&#x27;m not too keen on in the code. Up until now I think my attitude was possibly &quot;it works so that&#x27;s good enough&quot;. It was only me aware of the shortcomings. Now it&#x27;s public I&#x27;ll probably have more of an incentive to tidy up the rough edges. That&#x27;s the theory anyway - Embarrassment Driven Development anyone? :-)</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/poor-clares">Poor Clares</a><a class="margin-horiz--sm" href="/tags/continuous-delivery">Continuous Delivery</a><a class="margin-horiz--sm" href="/tags/arundel">Arundel</a><a class="margin-horiz--sm" href="/tags/app-veyor">AppVeyor</a></div><div class="col text--right"><a aria-label="Read more about The Convent with Continuous Delivery" href="/2015/02/11/the-convent-with-continuous-delivery"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/2015/01/07/deploying-aspnet-mvc-to-github-pages-with-appveyor-part-2">Deploying from ASP.Net MVC to GitHub Pages using AppVeyor part 2</a></h2><div class="margin-vert--md"><time datetime="2015-01-07T00:00:00.000Z" class="blogPostDate_fNvV">January 7, 2015 Â· 5 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>&quot;Automation, automation, automation.&quot; Those were and are Tony Blair&#x27;s priorities for keeping open source projects well maintained.</p><p> OK, that&#x27;s not quite true... But what is certainly true is that maintaining an open source project takes time. And there&#x27;s only so much free time that anyone has. For that reason, wherever you can it makes sense to <em>AUTOMATE</em>!</p><p><a href="https://blog.johnnyreilly.com/2014/12/deploying-aspnet-mvc-to-github-pages-with-appveyor-part-1.html" target="_blank" rel="noopener noreferrer">Last time</a> we looked at how you can take an essentially static ASP.Net MVC site (in this case my jVUNDemo documentation site) and generate an entirely static version using Wget. This static site has been pushed to <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a> and is serving as the documentation for <a href="http://johnnyreilly.github.io/jQuery.Validation.Unobtrusive.Native/" target="_blank" rel="noopener noreferrer">jQuery Validation Unobtrusive Native</a> (and for bonus points is costing me no money at all).</p><p>So what next? Well, automation clearly! If I make a change to jQuery Validation Unobtrusive Native then AppVeyor already bounds in and performs a <a href="https://ci.appveyor.com/project/JohnReilly/jquery-validation-unobtrusive-native" target="_blank" rel="noopener noreferrer">continuous integration build</a> for me. It picks up the <a href="https://github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native" target="_blank" rel="noopener noreferrer">latest source</a> from GitHub, pulls in my dependencies, performs a build and runs my tests. Lovely.</p><p>So the obvious thing to do is to take this process and plug in the generation of my static site and the publication thereof to GitHub pages. The minute a change is made to my project the documentation should be updated without me having to break sweat. That&#x27;s the goal.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="github-personal-access-token"></a>GitHub Personal Access Token<a class="hash-link" href="#github-personal-access-token" title="Direct link to heading">#</a></h2><p>In order to complete our chosen mission we&#x27;re going to need a GitHub Personal Access Token. We&#x27;re going to use it when we clone, update and push our GitHub Pages branch. To get one we biff over to Settings / Applications in GitHub and click the &quot;Generate New Token&quot; button.</p><p><img src="http://1.bp.blogspot.com/-TN1tTkL_eoQ/VKwQfPn8_JI/AAAAAAAAAyI/EeF6XLcP8dg/s640/GitHubApplicationSettings.png"></p><p>The token I&#x27;m using for my project has the following scopes selected:</p><p><img src="http://2.bp.blogspot.com/-2hsSnmHy_DY/VKwQo7MM0BI/AAAAAAAAAyQ/c5ZAT_mZi5w/s640/GitHub%2BPersonal%2BAccess%2BToken.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="appveyoryml"></a><code>appveyor.yml</code><a class="hash-link" href="#appveyoryml" title="Direct link to heading">#</a></h2><p>With our token in hand we turn our attention to AppVeyor build configuration. This is possible using a file called <a href="http://www.appveyor.com/docs/build-configuration" target="_blank" rel="noopener noreferrer"><code>appveyor.yml</code></a> stored in the root of your repo. You can also use the AppVeyor web UI to do this. However, for the purposes of ease of demonstration I&#x27;m using the file approach. The <a href="https://github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native/blob/master/appveyor.yml" target="_blank" rel="noopener noreferrer">jQuery Validation Unobtrusive Native <code>appveyor.yml</code></a> looks like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yml"><div tabindex="0" class="prism-code language-yml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#---------------------------------#</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#      general configuration      #</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#---------------------------------#</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># version format</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1.0.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#---------------------------------#</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#    environment configuration    #</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#---------------------------------#</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># environment variables</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">GithubEmail</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> johnny_reilly@hotmail.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">GithubUsername</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> johnnyreilly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">GithubPersonalAccessToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">secure</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> T4M/N+e/baksVoeWoYKPWIpfahOsiSFw/+Zc81VuThZmWEqmrRtgEHUyin0vCWhl    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">branches</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">only</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> master</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">install</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">ps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> choco install wget</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">verbosity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> minimal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">after_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">ps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ./makeStatic.ps1 $env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">APPVEYOR_BUILD_FOLDER</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">ps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ./pushStatic.ps1 $env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">APPVEYOR_BUILD_FOLDER $env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">GithubEmail $env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">GithubUsername $env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">GithubPersonalAccessToken</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>There&#x27;s a number of things you should notice from the yml file:</p><ul><li>We create 3 environment variables: GithubEmail, GithubUsername and GithubPersonalAccessToken (more on this in a moment).</li><li>We only build the master branch.</li><li>We use <a href="https://chocolatey.org/packages/Wget" target="_blank" rel="noopener noreferrer">Chocolatey</a> to install Wget which is used by the <code>makeStatic.ps1</code> Powershell script.</li><li>After the tests have completed we run 2 Powershell scripts. First <code>&lt;a href=&quot;https://github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native/blob/master/makeStatic.ps1&quot;&gt;makeStatic.ps1&lt;/a&gt;</code> which builds the static version of our site. This is the exact same script we discussed in the previous post - we&#x27;re just passing it the build folder this time (one of AppVeyor&#x27;s environment variables). Second, we run <code>&lt;a href=&quot;https://github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native/blob/master/pushStatic.ps1&quot;&gt;pushStatic.ps1&lt;/a&gt;</code> which publishes the static site to GitHub Pages.</li></ul><p>We pass 4 arguments to <code>pushStatic.ps1</code>: the build folder, my email address, my username and my personal access token. For the sake of security the GithubPersonalAccessToken has been encrypted as indicated by the <code>secure</code> keyword. This is a capability available in AppVeyor <a href="https://ci.appveyor.com/tools/encrypt" target="_blank" rel="noopener noreferrer">here</a>.</p><p><img src="http://1.bp.blogspot.com/-rQcNQPu2ass/VKwRC0QbQTI/AAAAAAAAAyY/8a8Qf5DGapA/s640/AppVeyor%2Bencrypt.png"></p><p>This allows me to mask my personal access token rather than have it available as free text for anyone to grab.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pushstaticps1"></a><code>pushStatic.ps1</code><a class="hash-link" href="#pushstaticps1" title="Direct link to heading">#</a></h2><p>Finally we can turn our attention to how our Powershell script <code>pushStatic.ps1</code> goes about pushing our changes up to GitHub Pages:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ps"><div tabindex="0" class="prism-code language-ps codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">param([string]$buildFolder, [string]$email, [string]$username, [string]$personalAccessToken)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Write-Host &quot;- Set config settings....&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git config --global user.email $email</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git config --global user.name $username</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git config --global push.default matching</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Write-Host &quot;- Clone gh-pages branch....&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd &quot;$($buildFolder)\..\&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir gh-pages</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git clone --quiet --branch=gh-pages https://$($username):$($personalAccessToken)@github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native.git .\gh-pages\</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd gh-pages</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Write-Host &quot;- Clean gh-pages folder....&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Get-ChildItem -Attributes !r | Remove-Item -Recurse -Force</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Write-Host &quot;- Copy contents of static-site folder into gh-pages folder....&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">copy-item -path ..\static-site\* -Destination $pwd.Path -Recurse</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$thereAreChanges = git status | select-string -pattern &quot;Changes not staged for commit:&quot;,&quot;Untracked files:&quot; -simplematch</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if ($thereAreChanges -ne $null) { </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Write-host &quot;- Committing changes to documentation...&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    git add --all</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    git status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    git commit -m &quot;skip ci - static site regeneration&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    git status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Write-Host &quot;- Push it....&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    git push --quiet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Write-Host &quot;- Pushed it good!&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">else { </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    write-host &quot;- No changes to documentation to commit&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>So what&#x27;s happening here? Let&#x27;s break it down:</p><ul><li>Git is configured with the passed in username and email address.</li><li>A folder is created that sits alongside the build folder called &quot;gh-pages&quot;.</li><li>We clone the &quot;gh-pages&quot; branch of jQuery Validation Unobtrusive Native into our &quot;gh-pages&quot; directory. You&#x27;ll notice that we are using our GitHub personal access token in the clone URL itself.</li><li>We delete the contents of the &quot;gh-pages&quot; directory leaving it empty.</li><li>We copy across the contents of the &quot;static-site&quot; folder (created by <code>makeStatic.ps1</code>) into the &quot;gh-pages&quot;.</li><li>We use <code>git status</code> to check if there are any changes. (This method is completely effective but a little crude to my mind - there&#x27;s probably better approaches to this.... shout me in the comments if you have a suggestion.)</li><li>If we have no changes then we do nothing.</li><li>If we have changes then we stage them, commit them and push them to GitHub Pages. Then we sign off with an allusion to <a href="https://en.wikipedia.org/wiki/Push_It_(Salt-n-Pepa_song)" target="_blank" rel="noopener noreferrer">80&#x27;s East Coast hip-hop</a>... &#x27;Cos that&#x27;s how we roll.</li></ul><p>With this in place, any changes to the docs will be automatically published out to our &quot;gh-pages&quot; branch. Our documentation will always be up to date thanks to the goodness of AppVeyor&#x27;s Continuous Integration service.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/git-hub-personal-access-token">GitHub Personal Access Token</a><a class="margin-horiz--sm" href="/tags/continuous-integration">Continuous Integration</a><a class="margin-horiz--sm" href="/tags/powershell">powershell</a><a class="margin-horiz--sm" href="/tags/github-pages">github pages</a><a class="margin-horiz--sm" href="/tags/app-veyor">AppVeyor</a></div><div class="col text--right"><a aria-label="Read more about Deploying from ASP.Net MVC to GitHub Pages using AppVeyor part 2" href="/2015/01/07/deploying-aspnet-mvc-to-github-pages-with-appveyor-part-2"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/2014/12/29/deploying-aspnet-mvc-to-github-pages-with-appveyor-part-1">Deploying from ASP.Net MVC to GitHub Pages using AppVeyor part 1</a></h2><div class="margin-vert--md"><time datetime="2014-12-29T00:00:00.000Z" class="blogPostDate_fNvV">December 29, 2014 Â· 6 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>There&#x27;s a small open source project I&#x27;m responsible for called <a href="https://github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native" target="_blank" rel="noopener noreferrer">jQuery Validation Unobtrusive Native</a>. (A catchy name is a must for any good open source project. Alas I&#x27;m not quite meeting my own exacting standards on this particular point... I should have gone with my gut and called it &quot;Livingstone&quot; instead. Too late now...)</p><p> The project itself is fairly simple in purpose. It&#x27;s essentially a bridge between ASP.Net MVC&#x27;s inbuilt support for driving validation from data attributes and jQuery Validation&#x27;s native support for the same. It is, in the end, a collection of ASP.Net MVC HTML helper extensions. It is not massively complicated.</p><p>I believe it was Tony Blair that said &quot;documentation, documentation, documentation&quot; were his priorities for open source projects. Or maybe it was someone else... Anyway, the point stands. Documentation is supremely important if you want your project to be in any way useful to anyone other than yourself. A project, no matter how fantastic, which lacks decent documentation is a missed opportunity.</p><p>Anyway I&#x27;m happy to say that jQuery Validation Unobtrusive Native <em>has</em> documentation! And pretty good documentation at that. The documentation takes the form of the <a href="https://github.com/johnnyreilly/jQuery.Validation.Unobtrusive.Native/tree/master/jVUNDemo" target="_blank" rel="noopener noreferrer">jVUNDemo</a> project which is part of the jQuery Validation Unobtrusive Native repo. jVUNDemo is an ASP.Net MVC web application which is built on top of the jQuery Validation Unobtrusive Native helpers. It demonstrates the helpers in action and documents how you might go about using them. It looks a bit like this:</p><p><img src="http://1.bp.blogspot.com/-5p7fD3Q9dc8/VKDzTV1wYDI/AAAAAAAAAxE/LowxrVAxeXI/s640/Screenshot%2B2014-12-29%2B06.22.46.png"></p><p>When I first put jVUNDemo together I hosted it on Azure so the world could see it in all it&#x27;s finery. And that worked just fine. However, there&#x27;s something you ought to know about me:</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="im-quite-cheap"></a>I&#x27;m quite cheap<a class="hash-link" href="#im-quite-cheap" title="Direct link to heading">#</a></h2><p>No really, I am. My attention was grabbed by the essentially &quot;free&quot; nature of <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. I was immediately seized by the desire to somehow deploy jVUNDemo to GitHub Pages and roll around joyfully in all that lovely free hosting.</p><p>&quot;But&quot;, I hear you cry, &quot;you can&#x27;t deploy an ASP.Net MVC application to Git Hub Pages... It only hosts static sites!&quot; Quite right. Sort of. This is where I get to pull my ace of spades: jVUNDemo is not really an &quot;app&quot; so much as a static site. Yup, once the HTML that makes up each page is generated there isn&#x27;t any app like business to do. It&#x27;s just a collection of text and 1 screen demo&#x27;s really.</p><p>That being the case, there&#x27;s no reason why I shouldn&#x27;t be able to make use of GitHub Pages. So that&#x27;s what I decided to do. Whilst I was at it I also wanted to automate the deployment process. When I tweak jVUNDemo I don&#x27;t want to have to manually push out a new version of jVUNDemo to wherever it&#x27;s being hosted. No, I&#x27;m a developer so I&#x27;ll automate it.</p><p>I&#x27;ve broken this up into 2 posts. This first one will cover how you generate a static site from an ASP.Net MVC site. The second will be about how to use <a href="http://www.appveyor.com/" target="_blank" rel="noopener noreferrer">AppVeyor</a> to ensure that on each build your documentation is getting republished.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="you-wget-me"></a>You Wget me?<a class="hash-link" href="#you-wget-me" title="Direct link to heading">#</a></h2><p>So, static site generation. There&#x27;s a well known Unix utility called <a href="https://en.wikipedia.org/wiki/Wget" target="_blank" rel="noopener noreferrer">Wget</a> which covers exactly that ground and so we&#x27;re going to use it. It downloads and saves HTML, it recursively walks the links inside the site and grabs those pages too and it converts our routes so they are locally browsable (&quot;Demo/Required&quot; becomes &quot;Demo/Required.html&quot;).</p><p>You can use <a href="https://chocolatey.org/packages/Wget" target="_blank" rel="noopener noreferrer">Chocolatey</a> to get a copy of Wget. We&#x27;re also going to need IIS Express to host jVUNDemo whilst Wget converts it. Once jVUNDemo has been built successfully you should be be able to kick off the process like so:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ps"><div tabindex="0" class="prism-code language-ps codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd C:\projects\jquery-validation-unobtrusive-native</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.\makeStatic.ps1 $pwd.path</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This invokes the <code>makeStatic</code> Powershell script in the root of the jQuery Validation Unobtrusive Native repo:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ps"><div tabindex="0" class="prism-code language-ps codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">param([string]$buildFolder)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$jVUNDemo = &quot;$($buildFolder)\jVUNDemo&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$staticSiteParentPath = (get-item $buildFolder).Parent.FullName</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$staticSite = &quot;static-site&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$staticSitePath = &quot;$($staticSiteParentPath)\$($staticSite)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$wgetLogPath = &quot;$($staticSiteParentPath)\wget.log&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$port = 57612</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$servedAt = &quot;http://localhost:$($port)/&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;jVUNDemo location: $jVUNDemo&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;static site parent location: $staticSiteParentPath&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;static site location: $staticSitePath&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;wget log path: $wgetLogPath&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;Spin up jVUNDemo site at $($servedAt)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$process = Start-Process &#x27;C:\Program Files (x86)\IIS Express\iisexpress.exe&#x27; -NoNewWindow -ArgumentList &quot;/path:$($jVUNDemo) /port:$($port)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;Wait a moment for IIS to startup&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Start-sleep -s 15</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if (Test-Path $staticSitePath) { </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    write-host &quot;Removing $($staticSitePath)...&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Remove-Item -path $staticSitePath -Recurse -Force</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;Create static version of demo site here: $($staticSitePath)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Push-Location $staticSiteParentPath</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 2&gt;&amp;1 used to combine stderr and stdout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">wget.exe --recursive --convert-links -E --directory-prefix=$staticSite --no-host-directories $servedAt &gt; $wgetLogPath 2&gt;&amp;1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;lastExitCode: $($lastExitCode)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cat $wgetLogPath</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Pop-Location</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write-host &quot;Shut down jVUNDemo site&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">stop-process -Name iisexpress</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if (Test-Path $staticSitePath) { </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    write-host &quot;Contents of $($staticSitePath)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ls $staticSitePath</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The above Powershell does the following:</p><ol><li>Starts up IIS Express serving jVUNDemo on http://localhost:57612/</li><li>Waits 15 seconds for IIS Express to get itself together (probably a shorter wait time would be sufficient)</li><li>Points Wget at jVUNDemo and bellows &quot;go!!!!&quot;</li><li>Wget downloads and saves the static version of jVUNDemo to a directory called &quot;static-site&quot;</li><li>Stops IIS Express</li><li>Prints out the contents of the &quot;static-site&quot; directory</li></ol><p>When run, it pumps something like this out:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">jVUNDemo location: C:\projects\jquery-validation-unobtrusive-native\jVUNDemo </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">static site parent location: C:\projects </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">static site location: C:\projects\static-site </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">wget log path: C:\projects\wget.log </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Spin up jVUNDemo site at http://localhost:57612/ </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Wait a moment for IIS to startup </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Create static version of demo site here: C:\projects\static-site </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">wget.exe : --2014-12-29 07:49:56--  http://localhost:57612/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Resolving localhost... </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">127.0.0.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Connecting to localhost|127.0.0.1|:57612... connected.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HTTP request sent, awaiting response... </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">200 OK</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">..... lots of HTTP requests.....</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Downloaded: 30 files, 1.0M in 0.09s (10.8 MB/s)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/CreditCard.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/Number.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/Range.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/Email.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/AdvancedDemo/CustomValidation.html... 35-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/Date.html... 36-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Home/License.html... 27-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/index.html... 29-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/AdvancedDemo/Dynamic.html... 35-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/MaxLengthMinLength.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/Required.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/AdvancedDemo.html... 32-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/Remote.html... 35-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/EqualTo.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/AdvancedDemo/Globalize.html... 38-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo/Url.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Demo.html... 37-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Home/GettingStarted.html... 29-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/Home/Download.html... 27-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converting static-site/AdvancedDemo/Tooltip.html... 34-0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Converted 20 files in 0.03 seconds.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Shut down jVUNDemo site </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Contents of C:\projects\static-site </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Directory: C:\projects\static-site</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mode                LastWriteTime     Length Name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">----                -------------     ------ ----</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">d----        12/29/2014   7:50 AM            AdvancedDemo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">d----        12/29/2014   7:50 AM            Content</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">d----        12/29/2014   7:50 AM            Demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">d----        12/29/2014   7:50 AM            Home</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">d----        12/29/2014   7:50 AM            Scripts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-a---        12/29/2014   7:50 AM       5967 AdvancedDemo.html</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-a---        12/29/2014   7:50 AM       6802 Demo.html</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-a---        12/29/2014   7:47 AM      12862 favicon.ico</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-a---        12/29/2014   7:50 AM       8069 index.html</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>And that&#x27;s it for part 1 my friends! You now have a static version of the ASP.Net MVC site to dazzle the world with. I should say for the purposes of full disclosure that there are 2 pages in the site which are not entirely &quot;static&quot; friendly. For these 2 pages I&#x27;ve put messages in that are displayed when the page is served up in a static format explaining the limitations. Their full glory can still be experienced by cloning the project and running locally.</p><p><a href="https://blog.johnnyreilly.com/2015/01/deploying-aspnet-mvc-to-github-pages-with-appveyor-part-2.html" target="_blank" rel="noopener noreferrer">Next time</a> we&#x27;ll take the mechanism detailed above and plug it into AppVeyor for some Continuous Integration happiness.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/wget">wget</a><a class="margin-horiz--sm" href="/tags/powershell">powershell</a><a class="margin-horiz--sm" href="/tags/github-pages">github pages</a><a class="margin-horiz--sm" href="/tags/app-veyor">AppVeyor</a></div><div class="col text--right"><a aria-label="Read more about Deploying from ASP.Net MVC to GitHub Pages using AppVeyor part 1" href="/2014/12/29/deploying-aspnet-mvc-to-github-pages-with-appveyor-part-1"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/2014/09/06/running-javascript-unit-tests-in-appveyor">Running JavaScript Unit Tests in AppVeyor</a></h2><div class="margin-vert--md"><time datetime="2014-09-06T00:00:00.000Z" class="blogPostDate_fNvV">September 6, 2014 Â· 3 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="with-a-little-help-from-chutzpah"></a>With a little help from Chutzpah...<a class="hash-link" href="#with-a-little-help-from-chutzpah" title="Direct link to heading">#</a></h2><p> <a href="http://www.appveyor.com" target="_blank" rel="noopener noreferrer">AppVeyor</a> (if you&#x27;re not aware of it) is a Continuous Integration provider. If you like, it&#x27;s plug-and-play CI for .NET developers. It&#x27;s lovely. And what&#x27;s more it&#x27;s <a href="http://www.appveyor.com/pricing" target="_blank" rel="noopener noreferrer">&quot;free for open-source projects with public repositories hosted on GitHub and BitBucket&quot;</a>. Boom! I recently hooked up 2 of my GitHub projects with AppVeyor. It took me all of... 10 minutes. If that? It really is *<strong>that</strong>* good.</p><p>But.... There had to be a &quot;but&quot; otherwise I wouldn&#x27;t have been writing the post you&#x27;re reading. For a little side project of mine called <a href="https://github.com/johnnyreilly/Proverb" target="_blank" rel="noopener noreferrer">Proverb</a> there were C# unit tests and there were JavaScript unit tests. And the JavaScript unit tests weren&#x27;t being run... No fair!!!</p><p><a href="https://chutzpah.codeplex.com/" target="_blank" rel="noopener noreferrer">Chutzpah</a> is a JavaScript test runner which at this point runs QUnit, Jasmine and Mocha JavaScript tests. I use the <a href="http://visualstudiogallery.msdn.microsoft.com/f8741f04-bae4-4900-81c7-7c9bfb9ed1fe" target="_blank" rel="noopener noreferrer">Visual Studio extension</a> to run Jasmine tests on my machine during development. I&#x27;ve also been able to use <a href="http://icanmakethiswork.blogspot.com/2014/03/the-surprisingly-happy-tale-of-visual.html" target="_blank" rel="noopener noreferrer">Chutzpah for CI purposes with Visual Studio Online / Team Foundation Server</a>. So what say we try and do the triple and make it work with AppVeyor too?</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="nuget-me"></a>NuGet me?<a class="hash-link" href="#nuget-me" title="Direct link to heading">#</a></h2><p>In order that I could run Chutzpah I needed Chutzpah to be installed on the build machine. So I had 2 choices:</p><ol><li>Add Chutzpah direct to the repo</li><li>Add the <a href="http://www.nuget.org/packages/chutzpah" target="_blank" rel="noopener noreferrer">Chutzpah Nuget package</a> to the solution</li></ol><p>Unsurprisingly I chose #2 - much cleaner.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="now-to-use-chutzpah"></a>Now to use Chutzpah<a class="hash-link" href="#now-to-use-chutzpah" title="Direct link to heading">#</a></h2><p>Time to dust down the PowerShell. I created myself a &quot;before tests script&quot; and added it to my build. It looked a little something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ps"><div tabindex="0" class="prism-code language-ps codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Locate Chutzpah</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ChutzpahDir = get-childitem chutzpah.console.exe -recurse | select-object -first 1 | select -expand Directory</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Run tests using Chutzpah and export results as JUnit format to chutzpah-results.xml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ChutzpahCmd = &quot;$($ChutzpahDir)\chutzpah.console.exe $($env:APPVEYOR_BUILD_FOLDER)\AngularTypeScript\Proverb.Web.Tests.JavaScript /junit .\chutzpah-results.xml&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Write-Host $ChutzpahCmd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Invoke-Expression $ChutzpahCmd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Upload results to AppVeyor one by one</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$testsuites = [xml](get-content .\chutzpah-results.xml)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$anyFailures = $FALSE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">foreach ($testsuite in $testsuites.testsuites.testsuite) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    write-host &quot; $($testsuite.name)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach ($testcase in $testsuite.testcase){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $failed = $testcase.failure</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $time = $testsuite.time</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($testcase.time) { $time = $testcase.time }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($failed) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            write-host &quot;Failed   $($testcase.name) $($testcase.failure.message)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Add-AppveyorTest $testcase.name -Outcome Failed -FileName $testsuite.name -ErrorMessage $testcase.failure.message -Duration $time</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            $anyFailures = $TRUE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            write-host &quot;Passed   $($testcase.name)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Add-AppveyorTest $testcase.name -Outcome Passed -FileName $testsuite.name -Duration $time</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if ($anyFailures -eq $TRUE){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    write-host &quot;Failing build as there are broken tests&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $host.SetShouldExit(1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>What this does is:</p><ol><li>Run Chutzpah from the installed NuGet package location, passing in the location of my Jasmine unit tests. In the case of my project there is a <code>chutzpah.json</code> file in the project which dictates how Chutzpah should run the tests. Also, <a href="https://chutzpah.codeplex.com/wikipage?title=Command%20Line%20Options&amp;referringTitle=Documentation" target="_blank" rel="noopener noreferrer">the JUnit flag is also passed</a> in order that Chutzpah creates a <code>chutzpah-results.xml</code> file of test results in the JUnit format.</li><li>We iterate through test results and tell AppVeyor about the the test passes and failures using the <a href="http://www.appveyor.com/docs/build-worker-api" target="_blank" rel="noopener noreferrer">Build Worker API</a>.</li><li>If there have been any failed tests then we fail the build. If you look <a href="https://ci.appveyor.com/project/JohnReilly/proverb/build/1.0.17" target="_blank" rel="noopener noreferrer">here</a> you can see a deliberately failed build which demo&#x27;s that this works as it should.</li></ol><p>That&#x27;s a wrap - We now have CI which includes our JavaScript tests! That&#x27;s right we get to see beautiful screens like these:</p><p><img src="http://4.bp.blogspot.com/--GGN2YPhzkk/VAtx-JUkwAI/AAAAAAAAAsg/XPIJ7PICFsA/s640/Screenshot%2B2014-09-06%2B21.43.15.png"></p><p><img src="http://3.bp.blogspot.com/-NNrq3w-EbCg/VAtzVPUOsqI/AAAAAAAAAsw/akwN8-J9K1k/s640/Screenshot%2B2014-09-06%2B21.49.38.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="thanks-to"></a>Thanks to...<a class="hash-link" href="#thanks-to" title="Direct link to heading">#</a></h2><p>Thanks to Dan Jones, whose comments on <a href="http://help.appveyor.com/discussions/questions/390-running-jasmine-on-appveyor#comment_34433599" target="_blank" rel="noopener noreferrer">this discussion</a> provided a number of useful pointers which moved me in the right direction. And thanks to Feador Fitzner who has generously <a href="http://help.appveyor.com/discussions/questions/495-integrating-chutzpah-into-appveyor#comment_34447202" target="_blank" rel="noopener noreferrer">said AppVeyor will support JUnit in the future</a> which may simplify use of Chutzpah with AppVeyor even further.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/jasmine">Jasmine</a><a class="margin-horiz--sm" href="/tags/javascript">javascript</a><a class="margin-horiz--sm" href="/tags/unit-tests">Unit tests</a><a class="margin-horiz--sm" href="/tags/continuous-integration">Continuous Integration</a><a class="margin-horiz--sm" href="/tags/app-veyor">AppVeyor</a><a class="margin-horiz--sm" href="/tags/chutzpah">Chutzpah</a></div><div class="col text--right"><a aria-label="Read more about Running JavaScript Unit Tests in AppVeyor" href="/2014/09/06/running-javascript-unit-tests-in-appveyor"><strong>Read More</strong></a></div></footer></article></div></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.buymeacoffee.com/qUBm0Wh" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/styles.043be7d3.js"></script>
<script src="/assets/js/runtime~main.49eec7a8.js"></script>
<script src="/assets/js/main.2e9ef896.js"></script>
<script src="/assets/js/1.61076fe0.js"></script>
<script src="/assets/js/2.def6ba93.js"></script>
<script src="/assets/js/6875c492.faaeecf0.js"></script>
<script src="/assets/js/c3b5bd8c.21066782.js"></script>
<script src="/assets/js/2fef477a.8815056e.js"></script>
<script src="/assets/js/b35d8c4a.d856f726.js"></script>
<script src="/assets/js/69a5cb2c.d7203c73.js"></script>
<script src="/assets/js/a85279d2.e6d3c839.js"></script>
<script src="/assets/js/476b20cf.42208473.js"></script>
<script src="/assets/js/4ba49fc7.517e6e22.js"></script>
<script src="/assets/js/90afdc47.47ec6f9b.js"></script>
</body>
</html>