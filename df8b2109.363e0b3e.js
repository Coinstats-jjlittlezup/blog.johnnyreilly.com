(window.webpackJsonp=window.webpackJsonp||[]).push([[782],{846:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return u}));var o=n(3),a=n(7),i=(n(0),n(960)),r={title:"How to attribute encode a PartialView in MVC (Razor)",author:"John Reilly",author_url:"https://github.com/johnnyreilly",author_image_url:"https://avatars.githubusercontent.com/u/1010525?s=400&u=294033082cfecf8ad1645b4290e362583b33094a&v=4",tags:["asp.net mvc","encode","PartialView","razor","attribute"],hide_table_of_contents:!1},l={permalink:"/blog.johnnyreilly.com/2012/08/24/how-to-attribute-encode-partialview-in",editUrl:"https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/blog/2012-08-24-how-to-attribute-encode-partialview-in.md",source:"@site/blog/2012-08-24-how-to-attribute-encode-partialview-in.md",description:"This post is plagiarism. But I'm plagiarising myself so I don't feel too bad.",date:"2012-08-24T00:00:00.000Z",tags:[{label:"asp.net mvc",permalink:"/blog.johnnyreilly.com/tags/asp-net-mvc"},{label:"encode",permalink:"/blog.johnnyreilly.com/tags/encode"},{label:"PartialView",permalink:"/blog.johnnyreilly.com/tags/partial-view"},{label:"razor",permalink:"/blog.johnnyreilly.com/tags/razor"},{label:"attribute",permalink:"/blog.johnnyreilly.com/tags/attribute"}],title:"How to attribute encode a PartialView in MVC (Razor)",readingTime:2.42,truncated:!1,prevItem:{title:"Globalize and jQuery Validation",permalink:"/blog.johnnyreilly.com/2012/09/06/globalize-and-jquery-validate"},nextItem:{title:"ClosedXML - the real SDK for Excel",permalink:"/blog.johnnyreilly.com/2012/08/16/closedxml-real-sdk-for-excel"}},s=[{value:"The Question",id:"the-question",children:[]},{value:"The Answer",id:"the-answer",children:[]},{value:"Final thoughts",id:"final-thoughts",children:[]}],c={toc:s};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"This post is plagiarism. But I'm plagiarising myself so I don't feel too bad."),Object(i.b)("p",null," I posted a ",Object(i.b)("a",{parentName:"p",href:"http://stackoverflow.com/q/12093005/761388"},"question")," on StackOverflow recently asking if there was a simple way to attribute encode a PartialView in Razor / ASP.NET MVC. I ended up answering my own question and since I thought it was a useful solution it might be worth sharing."),Object(i.b)("h2",{id:"the-question"},"The Question"),Object(i.b)("p",null,"In the project I was working on I was using PartialViews to store the HTML that would be rendered in a tooltip in my ASP.NET MVC application. (In case you're curious I was using the ",Object(i.b)("a",{parentName:"p",href:"http://jquerytools.org/demos/tooltip/index.html"},"jQuery Tools library for my tooltip")," effect.)"),Object(i.b)("p",null,"I had thought that Razor, clever beast that it is, would automatically attribute encode anything sat between quotes in my HTML. Unfortunately this doesn't appear to be the case. In the short term I was able to workaround this by using single quotation marks to encapsulate my PartialViews HTML. See below for an example:"),Object(i.b)("pre",null,'<div class="tooltip" title=\'@Html.Partial("_MyTooltipInAPartial")\'> Some content </div>'),Object(i.b)("p",null,"Now this worked just fine but I was aware that if any PartialView needed to use single quotation marks I would have a problem. Let's say for a moment that ",Object(i.b)("inlineCode",{parentName:"p"},"_MyTooltipInAPartial.cshtml")," contained this:"),Object(i.b)("pre",null,'<span style="color:green">fjkdsjf\'lksdjdlks</span>'),Object(i.b)("p",null,"Well when I used my handy little single quote workaround, the following would result:"),Object(i.b)("pre",null,'<div class="tooltip" title=\'<span style="color:green">fjkdsjf\'lksdjdlks</span>\'> Some content </div>'),Object(i.b)("p",null,"Which although it doesn't show up so well in the code sample above is definite ",Object(i.b)("em",{parentName:"p"},'"does not compute, does not compute, does not compute ',"*","LOUD EXPLOSION","*",'"')," territory."),Object(i.b)("h2",{id:"the-answer"},"The Answer"),Object(i.b)("p",null,"This took me back to my original intent which was to encapsulate the HTML in double quotes like this:"),Object(i.b)("pre",null,'<div class="tooltip" title="@Html.Partial("_MyTooltipInAPartial")"> Some content </div>'),Object(i.b)("p",null,"Though with the example discussed above we clearly had a problem whether we used single or double quotes. What to do?"),Object(i.b)("p",null,"Well the answer wasn't too complicated. After a little pondering I ended up scratching my own itch by writing an HTML helper method called ",Object(i.b)("inlineCode",{parentName:"p"},"PartialAttributeEncoded")," which made use of ",Object(i.b)("inlineCode",{parentName:"p"},"HttpUtility.HtmlAttributeEncode")," to HTML attribute encode a PartialView."),Object(i.b)("p",null,"Here's the code:"),Object(i.b)("script",{src:"https://gist.github.com/3449462.js?file=PartialExtensions.cs"}),Object(i.b)("p",null,"Using the above helper is simplicity itself:"),Object(i.b)("pre",null,'<div class="tooltip" title="@Html.PartialAttributeEncoded("_MyTooltipInAPartial")"> Some content </div>'),Object(i.b)("p",null,"And, given the example I've been going through, it would provide you with this output:"),Object(i.b)("pre",null,'<div class="tooltip" title="&lt;span style=&quot;color:green&quot;>fjkdsjf&#39;lksdjdlks</span>"> Some content </div>'),Object(i.b)("p",null,"Now the HTML in the title attribute above might be an unreadable mess - but it's the unreadable mess you need. That's what the HTML we've been discussing looks like when it's been encoded."),Object(i.b)("h2",{id:"final-thoughts"},"Final thoughts"),Object(i.b)("p",null,"I was surprised that Razor didn't handle this out of the box. I wonder if this is something that will come along with a later version? It's worth saying that I experienced this issue when working on an MVC 3 application. It's possible that this issue may actually have been solved with MVC 4 already; I haven't had chance to check yet though."))}u.isMDXComponent=!0},960:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var o=n(0),a=n.n(o);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),u=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},h=a.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=o,d=p["".concat(r,".").concat(h)]||p[h]||b[h]||i;return n?a.a.createElement(d,l(l({ref:t},c),{},{components:n})):a.a.createElement(d,l({ref:t},c))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var c=2;c<i;c++)r[c]=n[c];return a.a.createElement.apply(null,r)}return a.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"}}]);