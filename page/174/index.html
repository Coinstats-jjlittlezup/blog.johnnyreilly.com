<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51754530-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Blog | I CAN MAKE THIS WORK</title><meta data-react-helmet="true" property="og:title" content="Blog | I CAN MAKE THIS WORK"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/styles.a30a8c8e.css">
<link rel="preload" href="/styles.9c2995a9.js" as="script">
<link rel="preload" href="/runtime~main.e2b992e5.js" as="script">
<link rel="preload" href="/main.9ec81549.js" as="script">
<link rel="preload" href="/1.9d1369a3.js" as="script">
<link rel="preload" href="/2.3dd236d5.js" as="script">
<link rel="preload" href="/a6aa9e1f.6c8d1a94.js" as="script">
<link rel="preload" href="/c3b5bd8c.0459a1fb.js" as="script">
<link rel="preload" href="/1c98e0b7.bf566597.js" as="script">
<link rel="preload" href="/fa179952.01e75383.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/03/10/managed-identity-azure-sql-entity-framework">Managed Identity, Azure SQL and Entity Framework</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/03/06/generate-typescript-and-csharp-clients-with-nswag">Generate TypeScript and CSharp clients with NSwag based on an API</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/02/27/goodbye-client-affinity-hello-data-protection-with-azure">Goodbye Client Affinity, Hello Data Protection with Azure</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/02/16/easy-auth-tokens-survive-releases-on-linux-azure-app-service">Making Easy Auth tokens survive releases on Linux Azure App Service</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/2021/02/11/azure-app-service-health-checks-and-zero-downtime-deployments">Azure App Service, Health checks and zero downtime deployments</a></li></ul></div></div><main class="col col--8"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/2013/05/04/how-im-using-cassette">How I&#x27;m Using Cassette part 1:Getting Up and Running</a></h2><div class="margin-vert--md"><time datetime="2013-05-04T00:00:00.000Z" class="blogPostDate_Ta7i">May 4, 2013  Â· 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="backing-into-the-light"></a>Backing into the light<a class="hash-link" href="#backing-into-the-light" title="Direct link to heading">#</a></h2><p> For a while now, I&#x27;ve been seeking a bulletproof way to handle the following scenarios... all at the same time in the context of an ASP.Net MVC application:</p><ol><li>How to serve full-fat JavaScript in debug mode and minified in release mode</li><li>When debugging, ensure that the full-fat JS being served is definitely the latest version; and *<strong>not</strong>* from the cache. (The time I&#x27;ve wasted due to <a href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#304" target="_blank" rel="noopener noreferrer">304&#x27;s</a>...)</li><li>How to add Javascript assets that need to be served up from any point in an ASP.Net MVC application (including views, layouts, partial views... even controllers if so desired) whilst preventing duplicate scripts from being served.</li><li>How to ensure that Javascript files are served up last to any web page to ensure a speedy feel to users (don&#x27;t want JS blocking rendering).</li><li>And last but certainly not least the need to load Javascript files in dependency order. If <code>myView.js</code> depends on jQuery then clearly <code>jQuery-latest.js</code> needs to be served before <code>myView.js</code>.</li></ol><p>Now the best, most comprehensive and solid looking solution to this problem has for some time seemed to me to be <a href="http://aboutcode.net/" target="_blank" rel="noopener noreferrer">Andrew Davey&#x27;s</a><a href="http://getcassette.net/" target="_blank" rel="noopener noreferrer">Cassette</a>. This addresses all my issues in one way or another, as well as bringing in a raft of other features (support for Coffeescript etc).</p><p>However, up until now I&#x27;ve slightly shied away from using Cassette as I was under the impression it had a large number of dependencies. That doesn&#x27;t appear to be the case at all. I also had some vague notion that I could quite simply build my own solution to these problems making use of Microsoft&#x27;s <a href="http://nuget.org/packages/Microsoft.AspNet.Web.Optimization/1.0.0" target="_blank" rel="noopener noreferrer">Web Optimization</a> which nicely handles my #1 problem above. However, looking again at the documentation Cassette was promising to handle scenarios #1 - #5 without breaking sweat. How could I ignore that? I figured I should do the sensible thing and take another look at it. And, lo and behold, when I started evaluating it again it seemed to be just what I needed.</p><p>With the minumum of fuss I was able to get an ASP.Net MVC 4 solution up and running, integrated with Cassette, which dealt with all my scenarios very nicely indeed. I thought it might be good to write this up over a short series of posts and share what my finished code looks like. If you follow the steps I go through below it&#x27;ll get you started using Cassette. Or you could skip to the end of this post and look at the repo on GitHub. Here we go...</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="adding-cassette-to-a-raw-mvc-4-project"></a>Adding Cassette to a raw MVC 4 project<a class="hash-link" href="#adding-cassette-to-a-raw-mvc-4-project" title="Direct link to heading">#</a></h2><p>Fire up Visual Studio and create a new MVC 4 project (I used the internet template to have some content in place).</p><p>Go to the Package Manager Console and key in &quot;<code>Install-Package Cassette.Aspnet</code>&quot;. Cassette will install itself.</p><p>Now you&#x27;ve got Cassette in place you may as well pull out usage of Web Optimization as you&#x27;re not going to need it any more.Be ruthless, delete App_Start/BundleConfig.cs and delete the line of code that references it in Global.asax.cs. If you take the time to run the app now you&#x27;ll see you&#x27;ve miraculously lost your CSS and your JavaScript. The code referencing it is still in place but there&#x27;s nothing for it to serve up. Don&#x27;t worry about that - we&#x27;re going to come back and Cassette-ify things later on...</p><p>You&#x27;ll also notice you now have a CassetteConfiguration.cs file in your project. Open it. Replace the contents with this (I&#x27;ve just commented out the default code and implemented my own CSS and Script bundles based on what is available in the default template of an MVC 4 app):</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=CassetteConfiguration.cs"></script><p>In the script above I&#x27;ve created 4 bundles, 1 stylesheet bundle and 3 JavaScript bundles - each of these is roughly equivalent to Web Optimization bundles that are part of the MVC 4 template:</p><dl><dt>~/bundles/css</dt><dd>Our site CSS - this includes both our own CSS and the jQuery UI CSS as well. This is the rough equivalent of the Web Optimization bundles <em>~/Content/css</em> and <em>~/Content/themes/base/css</em> brought together.</dd><dt>~/bundles/head</dt><dd>What scripts we want served in the head tag - Modernizr basically. Do note the setting of the <em>PageLocation</em> property - the purpose of this will become apparent later. This is the direct equivalent of the Web Optimization bundle: <em>~/bundles/modernizr</em>.</dd><dt>~/bundles/core</dt><dd>The scripts we want served on every page. For this example project I&#x27;ve picked jQuery and jQuery UI. This is the rough equivalent of the Web Optimization bundles <em>~/bundles/jquery</em> and <em>~/bundles/jqueryui</em> brought together.</dd><dt>~/bundles/validate</dt><dd>The validation scripts (that are dependent on the core scripts). This is the rough equivalent of the Web Optimization bundle: <em>~/bundles/jqueryval</em>.</dd></dl><p>At this point we&#x27;ve set up Cassette in our project - although we&#x27;re not making use of it yet. If you want to double check that everything is working properly then you can fire up your project and browse to &quot;Cassette.axd&quot; in the root. You should see something a bit like this:</p><p><a href="http://1.bp.blogspot.com/-xM9iU6HjB7o/UWzjAN5EieI/AAAAAAAAAaA/EAXTTnD6vdY/s1600/CassetteScripts.png" target="_blank" rel="noopener noreferrer"><img src="http://1.bp.blogspot.com/-xM9iU6HjB7o/UWzjAN5EieI/AAAAAAAAAaA/EAXTTnD6vdY/s320/CassetteScripts.png" alt="null"></a>## How Web Optimization and Cassette Differ</p><p>If you&#x27;re more familiar with the workings of Web Optimization than Cassette then it&#x27;s probably worth taking a moment to appreciate an important distinction between the slightly different ways each works.</p><p><strong>Web Optimization</strong></p><ol><li>Create bundles as desired.</li><li>Serve up bundles and / or straight JavaScript files as you like within your MVC views / partial views / layouts. </li></ol><p><strong>Cassette</strong></p><ol><li>Create bundles for *<strong>all</strong>* JavaScript files you wish to serve up. You may wish to create some bundles which consist of a number of a number of JavaScript files pushed together. But for each individual file you wish to serve you also need to create an individual bundle. (Failure to do so may mean you fall prey to the &quot;<em>Cannot find an asset bundle containing the path &quot;~/Scripts/somePath.js&quot;.</em>&quot;)</li><li>Reference bundles and / or individual JavaScript files in their individual bundles as you like within your MVC views / partial views / layouts / controllers / HTML helpers... the list goes on!</li><li>Render the referenced scripts to the page (typically just before the closing <code>body</code> tag)</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="making-use-of-our-bundles"></a>Making use of our Bundles<a class="hash-link" href="#making-use-of-our-bundles" title="Direct link to heading">#</a></h2><p>Now we&#x27;ve created our bundles let&#x27;s get the project serving up CSS and JavaScript using Cassette. First the layout file. Take the <code>_Layout.cshtml</code> file from this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=_LayoutBefore.cshtml"></script><p>To this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=_LayoutAfter.cshtml"></script><p>And now let&#x27;s take one of the views, <code>Login.cshtml</code> and take it from this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=LoginBefore.cshtml"></script><p>To this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=LoginAfter.cshtml"></script><p>So now you should be up and running with Cassette. If you want the code behind this then take I&#x27;ve put it on GitHub <a href="https://github.com/johnnyreilly/CassetteDemo" target="_blank" rel="noopener noreferrer">here</a>.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/asp-net-mvc">asp.net mvc</a><a class="margin-horiz--sm" href="/tags/andrew-davey">Andrew Davey</a><a class="margin-horiz--sm" href="/tags/cassette">cassette</a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/page/173"><div class="pagination-nav__label">Â« Newer Entries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/page/175"><div class="pagination-nav__label">Older Entries Â»</div></a></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.9c2995a9.js"></script>
<script src="/runtime~main.e2b992e5.js"></script>
<script src="/main.9ec81549.js"></script>
<script src="/1.9d1369a3.js"></script>
<script src="/2.3dd236d5.js"></script>
<script src="/a6aa9e1f.6c8d1a94.js"></script>
<script src="/c3b5bd8c.0459a1fb.js"></script>
<script src="/1c98e0b7.bf566597.js"></script>
<script src="/fa179952.01e75383.js"></script>
</body>
</html>