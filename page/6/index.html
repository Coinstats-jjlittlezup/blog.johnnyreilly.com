<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog.johnnyreilly.com/rss.xml" title="I CAN MAKE THIS WORK Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog.johnnyreilly.com/atom.xml" title="I CAN MAKE THIS WORK Blog Atom Feed"><title data-react-helmet="true">Blog | I CAN MAKE THIS WORK</title><meta data-react-helmet="true" property="og:title" content="Blog | I CAN MAKE THIS WORK"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/blog.johnnyreilly.com/img/favicon.ico"><link rel="stylesheet" href="/blog.johnnyreilly.com/styles.a755cef0.css">
<link rel="preload" href="/blog.johnnyreilly.com/styles.e251ffc4.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/runtime~main.17090397.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/main.76845b2c.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/1.32932134.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/2.7bb643e8.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/a6aa9e1f.f671cbae.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/c3b5bd8c.b09f7905.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/012d4097.18bab675.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/cb8d7bac.ce560a11.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/d7a60416.16290ba7.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/3c656591.945fd274.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/8e0d145b.5dae1524.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/0a977c03.08e9abe0.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/4424fda7.df76d9f9.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/78d410a3.4b6e4ad2.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/e415f8a6.3775f66d.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/8fb3131e.3a97ca31.js" as="script">
<link rel="preload" href="/blog.johnnyreilly.com/183b754e.58338be8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/blog.johnnyreilly.com/"><img src="/blog.johnnyreilly.com/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/blog.johnnyreilly.com/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/blog.johnnyreilly.com/"><img src="/blog.johnnyreilly.com/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/blog.johnnyreilly.com/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog.johnnyreilly.com/2021/03/06/generate-typescript-and-csharp-clients-with-nswag">Generate TypeScript and CSharp clients with NSwag based on an API</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog.johnnyreilly.com/2021/02/27/goodbye-client-affinity-hello-data-protection-with-azure">Goodbye Client Affinity, Hello Data Protection with Azure</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog.johnnyreilly.com/2021/02/16/easy-auth-tokens-survive-releases-on-linux-azure-app-service">Making Easy Auth tokens survive releases on Linux Azure App Service</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog.johnnyreilly.com/2021/02/11/azure-app-service-health-checks-and-zero-downtime-deployments">Azure App Service, Health checks and zero downtime deployments</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog.johnnyreilly.com/2021/02/08/arm-templates-security-role-assignments">ARM templates, security, role assignments and magic GUIDs</a></li></ul></div></div><main class="col col--8"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2019/01/05/github-actions-and-yarn">GitHub Actions and Yarn</a></h2><div class="margin-vert--md"><time datetime="2019-01-05T00:00:00.000Z" class="blogPostDate_Ta7i">January 5, 2019  · 5 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>I&#x27;d been meaning to automate the npm publishing of <a href="https://github.com/TypeStrong/ts-loader" target="_blank" rel="noopener noreferrer"><code>ts-loader</code></a> for the longest time. I had attempted to use Travis to do this in the same way as <a href="https://github.com/Realytics/fork-ts-checker-webpack-plugin" target="_blank" rel="noopener noreferrer"><code>fork-ts-checker-webpack-plugin</code></a>. Alas using secure environment variables in Travis has unfortunate implications for ts-loader&#x27;s test pack.</p><p>Be not afeard. I&#x27;ve heard there&#x27;s a new shiny thing from GitHub that I could use instead... It&#x27;s a sign; I must use it!</p><p>GitHub Actions are still in beta. Technically Actions are <a href="https://developer.github.com/actions/creating-github-actions/" target="_blank" rel="noopener noreferrer">code run in Docker containers</a> in response to events. This didn&#x27;t mean a great deal to me until I started thinking about what I wanted to do with <code>ts-loader</code>&#x27;s publishing flow.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="automate-what"></a>Automate What?<a class="hash-link" href="#automate-what" title="Direct link to heading">#</a></h2><p>Each time I publish a release of <code>ts-loader</code> I execute the following node commands by hand:</p><ol><li><code>yarn install</code> - to install <code>ts-loader</code>&#x27;s dependencies</li><li><code>yarn build</code> - to build <code>ts-loader</code></li><li><code>yarn test</code> - to run <code>ts-loader</code>&#x27;s test packs</li><li><code>npm publish</code> - to publish the release of <code>ts-loader</code> to npm</li></ol><p>Having read up on GitHub Actions it seemed like they were born to handle this sort of task.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="github-action-for-npm"></a>GitHub Action for <code>npm</code><a class="hash-link" href="#github-action-for-npm" title="Direct link to heading">#</a></h2><p>I quickly discovered that someone out there <s>loves me</s></p><p> had <a href="https://github.com/actions/npm" target="_blank" rel="noopener noreferrer">already written a GitHub Action for <code>npm</code></a>.</p><p>The example in the <a href="https://github.com/actions/npm/blob/master/README.md" target="_blank" rel="noopener noreferrer"><code>README.md</code></a> could be easily tweaked to meet my needs with one caveat: I had to use <code>npm</code> in place of <code>yarn</code>. I didn&#x27;t want to switch from <code>yarn</code>. What to do?</p><p>Well, remember when I said actions are code run in Docker containers? Another way to phrase that is to say: GitHub Actions are Docker images. Let&#x27;s look under the covers of the <code>npm</code> GitHub Action. As we peer inside the <a href="https://github.com/actions/npm/blob/e7aaefed7c9f2e83d493ff810f17fa5ccd7ed437/Dockerfile#L1" target="_blank" rel="noopener noreferrer"><code>Dockerfile</code></a> what do we find?</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">FROM node:10-slim</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Hmmmm.... Interesting. The base image of the <code>npm</code> GitHub Action is <code>node:10-slim</code>. Looking it up, it seems the <code>-slim</code> Docker images come with <a href="https://github.com/nodejs/docker-node/blob/master/Dockerfile-slim.template" target="_blank" rel="noopener noreferrer"><code>yarn</code> included</a>. Which means we should be able to use <code>yarn</code> inside the <code>npm</code> GitHub Action. Nice!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="github-action-for-npm-for-yarn"></a>GitHub Action for <code>npm</code> for <code>yarn</code><a class="hash-link" href="#github-action-for-npm-for-yarn" title="Direct link to heading">#</a></h2><p>Using <code>yarn</code> from the GitHub Action for <code>npm</code> is delightfully simple. Here&#x27;s what running <code>npm install</code> looks like:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># install with npm</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action &quot;install&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uses = &quot;actions/npm@1.0.0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args = &quot;install&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Pivoting to use <code>yarn install</code> instead of <code>npm install</code> is as simple as:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># install with yarn</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action &quot;install&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uses = &quot;actions/npm@1.0.0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  runs = &quot;yarn&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args = &quot;install&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can see we&#x27;ve introduced the <code>runs = &quot;yarn&quot;</code> and after that the <code>args</code> are whatever you need them to be.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="going-with-the-workflow"></a>Going With The Workflow<a class="hash-link" href="#going-with-the-workflow" title="Direct link to heading">#</a></h2><p>A GitHub Workflow that implements the steps I need would look like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">workflow &quot;build, test and publish on release&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  on = &quot;push&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  resolves = &quot;publish&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># install with yarn</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action &quot;install&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uses = &quot;actions/npm@1.0.0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  runs = &quot;yarn&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args = &quot;install&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># build with yarn</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action &quot;build&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  needs = &quot;install&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uses = &quot;actions/npm@1.0.0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  runs = &quot;yarn&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args = &quot;build&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># test with yarn</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action &quot;test&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  needs = &quot;build&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uses = &quot;actions/npm@1.0.0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  runs = &quot;yarn&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args = &quot;test&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># filter for a new tag</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action &quot;check for new tag&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  needs = &quot;Test&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uses = &quot;actions/bin/filter@master&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args = &quot;tag&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># publish with npm</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">action &quot;publish&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  needs = &quot;check for new tag&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uses = &quot;actions/npm@1.0.0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args = &quot;publish&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  secrets = [&quot;NPM_AUTH_TOKEN&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>As you can see, this is a direct automation of steps 1-4 I listed earlier. Since all these actions are executed in the same container, we can skip from <code>yarn</code> to <code>npm</code> with gay abandon.</p><p>What&#x27;s absolutely amazing is, when I got access to GitHub Actions <a href="https://github.com/TypeStrong/ts-loader/blob/master/.github/main.workflow" target="_blank" rel="noopener noreferrer">my hand crafted workflow</a> looked like it should work first time! I know, right? Don&#x27;t you love it when that happens? <a href="https://github.com/actions/bin/issues/13" target="_blank" rel="noopener noreferrer">Alas there&#x27;s presently a problem with filters in GitHub Actions</a>. But that&#x27;s by the by, if you&#x27;re just looking to use a GitHub Action with yarn instead of npm then you are home free.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="you-dont-actually-need-the-npm-github-action"></a>You Don&#x27;t Actually Need the npm GitHub Action<a class="hash-link" href="#you-dont-actually-need-the-npm-github-action" title="Direct link to heading">#</a></h2><p>You heard me right. Docker containers be Docker containers. You don&#x27;t actually need to use this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uses = &quot;actions/npm@1.0.0&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can use <em>any</em> Docker container which has node / npm installed! So if you&#x27;d like to use say node 11 instead you could just do this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">uses = &quot;docker://node:11&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Which would use the node 11 image on <a href="https://hub.docker.com/_/node" target="_blank" rel="noopener noreferrer">docker hub</a>.</p><p>Which is pretty cool. You know what&#x27;s even more incredible? Inside a workflow you can switch <code>uses</code> mid-workflow and keep the output. That&#x27;s right; you can have a work flow with say three actions running <code>uses = &quot;docker://node:11&quot;</code> and then a fourth running <code>uses = &quot;actions/npm@1.0.0&quot;</code>. That&#x27;s <em>so</em> flexible and powerful!</p><p>Thanks to <a href="https://github.com/mcolyer" target="_blank" rel="noopener noreferrer">Matt Colyer</a> and <a href="https://github.com/LandonSchropp" target="_blank" rel="noopener noreferrer">Landon Schropp</a> for <a href="https://github.com/actions/npm/issues/9" target="_blank" rel="noopener noreferrer">schooling me on the intricicies of GitHub Actions</a>. Much ❤</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/docker">docker</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/yarn">yarn</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/git-hub-actions">GitHub Actions</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/12/22/you-might-not-need-thread-loader">You Might Not Need thread-loader</a></h2><div class="margin-vert--md"><time datetime="2018-12-22T00:00:00.000Z" class="blogPostDate_Ta7i">December 22, 2018  · 4 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>It all started with a GitHub issue. <a href="https://github.com/namics/webpack-config-plugins/issues/24" target="_blank" rel="noopener noreferrer">Ernst Ammann reported</a>:</p><blockquote><p>Without the thread-loader, compilation takes three to four times less time on changes. We could remove it.</p></blockquote><p>If you&#x27;re not aware of the <a href="https://github.com/namics/webpack-config-plugins" target="_blank" rel="noopener noreferrer"><code>webpack-config-plugins</code></a> project then I commend it to you. Famously, webpack configuration can prove tricky. <code>webpack-config-plugins</code> borrows the idea of presets from Babel. It provides a number of pluggable webpack configurations which give a best practice setup for different webpack use cases. So if you&#x27;re no expert with webpack and you want a good setup for building your TypeScript / Sass / JavaScript then <code>webpack-config-plugins</code> has got your back.</p><p>One of the people behind the project is the very excellent <a href="https://github.com/jantimon" target="_blank" rel="noopener noreferrer">Jan Nicklas</a> who is well known for his work on the <a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener noreferrer"><code>html-webpack-plugin</code></a>.</p><p>It was Jan who responded to Ernst&#x27;s issue and decided to look into it.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="all-i-want-for-christmas-is-faster-builds"></a>All I Want For Christmas is Faster Builds<a class="hash-link" href="#all-i-want-for-christmas-is-faster-builds" title="Direct link to heading">#</a></h2><p>Everyone wants fast builds. I do. You do. We all do. <code>webpack-config-plugins</code> is about giving these to the user in a precooked package.</p><p>There&#x27;s a webpack loader called <a href="https://github.com/webpack-contrib/thread-loader" target="_blank" rel="noopener noreferrer"><code>thread-loader</code></a> which spawns multiple processes and splits up work between them. It was originally inspired by the work in the happypack project which does a similar thing.</p><p>I wrote <a href="https://medium.com/p/83cc568dea79" target="_blank" rel="noopener noreferrer">a blog post</a> some time ago which gave details about ways to speed up your TypeScript builds by combining the <a href="https://github.com/TypeStrong/ts-loader" target="_blank" rel="noopener noreferrer"><code>ts-loader</code></a> project (which I manage) with the <a href="https://github.com/Realytics/fork-ts-checker-webpack-plugin" target="_blank" rel="noopener noreferrer"><code>fork-ts-checker-webpack-plugin</code></a> project (which I&#x27;m heavily involved with).</p><p>That post was written back in the days of webpack 2 / 3. It advocated use of both <code>happypack</code> / <code>thread-loader</code> to drop your build times even further. As you&#x27;ll see, now that we&#x27;re well into the world of webpack 4 (with webpack 5 waiting in the wings) the advantage of <code>happypack</code> / <code>thread-loader</code> are no longer so profound.</p><p><code>webpack-config-plugins</code> follows the advice I set out in my post; it uses <code>thread-loader</code> in its pluggable configurations. Now, back to Ernst&#x27;s issue.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="thread-loader-infinity-war"></a><code>thread-loader</code>: Infinity War<a class="hash-link" href="#thread-loader-infinity-war" title="Direct link to heading">#</a></h2><p>Jan quickly identified the problem. He did that rarest of things; he read the documentation which said:</p><div class="mdxCodeBlock_1zKU">      // timeout for killing the worker processes when idle // defaults to 500 (ms) // can be set to Infinity for watching builds to keep workers alive poolTimeout: 2000,</div><p>The <code>webpack-config-plugins</code> configurations (running in watch mode) were subject to the thread loaders being killed after 500ms. They got resurrected when they were next needed; but that&#x27;s not as instant as you might hope. Jan then did a test:</p><div class="mdxCodeBlock_1zKU">(default pool - 30 runs - 1000 components ) average: 2.668068965517241 (no thread-loader - 30 runs - 1000 components ) average: 1.2674137931034484 (Infinity pool - 30 runs - 1000 components ) average: 1.371827586206896</div><p>This demonstrates that using <code>thread-loader</code> in watch mode with <code>poolTimeout: Infinity</code> performs significantly better than when it defaults to 500ms. But perhaps more significantly, not using <code>thread-loader</code> performs even better still.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="maybe-youve-thread-enough"></a>&quot;Maybe You&#x27;ve Thread Enough&quot;<a class="hash-link" href="#maybe-youve-thread-enough" title="Direct link to heading">#</a></h2><p>When I tested using <code>thread-loader</code> in watch mode with <code>poolTimeout: Infinity</code> on my own builds I got the same benefit Jan had. I also got <em>even</em> more benefit from dropping <code>thread-loader</code> entirely.</p><p>A likely reason for this benefit is that typically when you&#x27;re developing, you&#x27;re working on one file at a time. Hence you only transpile one file at a time:</p><p><a href="https://2.bp.blogspot.com/-u2nbxnUAJXQ/XB8y1mF6hoI/AAAAAAAANRU/biYIfBaDsDwnNA2jp_YLNrLBcXWITAM1ACPcBGAYYCw/s1600/ts-profile2.png" target="_blank" rel="noopener noreferrer">![null](&lt;https://2.bp.blogspot.com/-u2nbxnUAJXQ/XB8y1mF6hoI/AAAAAAAANRU/biYIfBaDsDwnNA2jp_YLNrLBcXWITAM1ACPcBGAYYCw/s640/ts-profile2.png&gt; =640x173)</a>So there&#x27;s not a great deal of value that <code>thread-loader</code> can add here; mostly it&#x27;s twiddling thumbs and adding an overhead. <a href="https://github.com/webpack-contrib/thread-loader/blob/master/README.md#usage" target="_blank" rel="noopener noreferrer">To quote the docs:</a></p><blockquote><p>Each worker is a separate node.js process, which has an overhead of ~600ms. There is also an overhead of inter-process communication.</p><p>Use this loader only for expensive operations!</p></blockquote><p>Now, my build is not your build. I can&#x27;t guarantee that you&#x27;ll get the same results as Jan and I experienced; but I would encourage you to investigate if you&#x27;re using <code>thread-loader</code> correctly and whether it&#x27;s actually helping you. In these days of webpack 4+ perhaps it isn&#x27;t.</p><p>There are still scenarios where <code>thread-loader</code> still provides an advantage. It can speed up production builds. It can speed up the initial startup of watch mode. <a href="https://github.com/webpack-contrib/thread-loader/pull/52" target="_blank" rel="noopener noreferrer">In fact Jan has subsequently actually improved the <code>thread-loader</code> to that specific end.</a> Yay Jan!</p><p>If this is all too much for you, and you want to hand off the concern to someone else then perhaps all of this serves as a motivation to just sit back, put your feet up and start using <a href="https://github.com/namics/webpack-config-plugins" target="_blank" rel="noopener noreferrer"><code>webpack-config-plugins</code></a> instead of doing your own configuration.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/happy-pack">HappyPack</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/thread-loader">thread-loader</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/fork-ts-checker-webpack-plugin">fork-ts-checker-webpack-plugin</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/ts-loader">ts-loader</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/webpack">Webpack</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/fast-builds">fast builds</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/12/10/cache-rules-everything-around-me">Cache Rules Everything Around Me</a></h2><div class="margin-vert--md"><time datetime="2018-12-10T00:00:00.000Z" class="blogPostDate_Ta7i">December 10, 2018  · 2 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>One thing that ASP.Net Core really got right was caching. <code>&lt;a href=&quot;https://docs.microsoft.com/en-us/aspnet/core/performance/caching/memory&quot;&gt;IMemoryCache&lt;/a&gt;</code> is a caching implementation that does just what I want. I love it. I take it everywhere. I&#x27;ve introduced it to my family.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="timespan-timespan-expiration-yall"></a>TimeSpan, TimeSpan Expiration Y&#x27;all<a class="hash-link" href="#timespan-timespan-expiration-yall" title="Direct link to heading">#</a></h2><p>To make usage of the <code>IMemoryCache</code><em>even</em> more lovely I&#x27;ve written an extension method. I follow pretty much one cache strategy: <code>SetAbsoluteExpiration</code> and I just vary the expiration by an amount of time. This extension method implements that in a simple way; I call it <code>GetOrCreateForTimeSpanAsync</code> - catchy right? It looks like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cs codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System.Threading.Tasks;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using Microsoft.Extensions.Caching.Memory;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace My.Helpers {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static class CacheHelpers {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public static async Task&lt;TItem&gt; GetOrCreateForTimeSpanAsync&lt;TItem&gt;(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            this IMemoryCache cache,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            string key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Func&lt;Task&lt;TItem&gt;&gt; itemGetterAsync,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            TimeSpan timeToCache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (!cache.TryGetValue(key, out object result)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                result = await itemGetterAsync();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (result == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    return default(TItem);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                var cacheEntryOptions = new MemoryCacheEntryOptions()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    .SetAbsoluteExpiration(timeToCache);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                cache.Set(key, result, cacheEntryOptions);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return (TItem) result;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Usage looks like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cs codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">private Task&lt;superinterestingthing&gt; GetSuperInterestingThingFromCache(Guid superInterestingThingId) =&gt; </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    _cache.GetOrCreateForTimeSpanAsync(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        key: $&quot;{nameof(MyClass)}:GetSuperInterestingThing:{superInterestingThingId}&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        itemGetterAsync: () =&gt; GetSuperInterestingThing(superInterestingThingId),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        timeToCache: TimeSpan.FromMinutes(5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/superinterestingthing&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This helper allows the consumer to provide three things:</p><ul><li>The <code>key</code> key for the item to be cached with</li><li>A <code>itemGetterAsync</code> which is the method that is used to retrieve a new value if an item cannot be found in the cache</li><li>A <code>timeToCache</code> which is the period of time that an item should be cached</li></ul><p>If an item can&#x27;t be looked up by the <code>itemGetterAsync</code> then <em>nothing</em> will be cached and a the <code>default</code> value of the expected type will be returned. This is important because lookups can fail, and there&#x27;s nothing worse than a lookup failing and you caching <code>null</code> as a result.</p><p>Go on, ask me how I know.</p><p>This is a simple, clear and helpful API which makes interacting with <code>IMemoryCache</code> even more lovely than it was. Peep it y&#x27;all.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/asp-net-core">asp net core</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/cache">cache</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/wu-tang">wu-tang</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/11/17/snapshot-testing-for-c">Snapshot Testing for C#</a></h2><div class="margin-vert--md"><time datetime="2018-11-17T00:00:00.000Z" class="blogPostDate_Ta7i">November 17, 2018  · 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>If you&#x27;re a user of Jest, you&#x27;ve no doubt heard of and perhaps made use of <a href="https://jestjs.io/docs/en/snapshot-testing" target="_blank" rel="noopener noreferrer">snapshot testing</a>.</p><p> Snapshot testing is an awesome tool that is generally discussed in the context of JavaScript React UI testing. But snapshot testing has a wider application than that. Essentially it is profoundly useful where you have functions which produce a complex structured output. It could be a React UI, it could be a list of FX prices. The type of data is immaterial; it&#x27;s the amount of it that&#x27;s key.</p><p>Typically there&#x27;s a direct correlation between the size and complexity of the output of a method and the length of the tests that will be written for it. Let&#x27;s say you&#x27;re outputting a class that contains 20 properties. Congratulations! You get to write 20 assertions in one form or another for each test case. Or a single assertion whereby you supply the expected output by hand specifying each of the 20 properties. Either way, that&#x27;s not going to be fun. And just imagine the time it would take to update multiple test cases if you wanted to change the behaviour of the method in question. Ouchy.</p><p>Time is money kid. What you need is snapshot testing. Say goodbye to handcrafted assertions and hello to JSON serialised output checked into source control. Let&#x27;s unpack that a little bit. The usefulness of snapshot testing that I want in C# is predominantly about removing the need to write and maintain multiple assertions. Instead you write tests that compare the output of a call to your method with JSON serialised output you&#x27;ve generated on a previous occasion.</p><p>This approach takes less time to write, less time to maintain and the solid readability of JSON makes it more likely you&#x27;ll pick up on bugs. It&#x27;s so much easier to scan JSON than it is a list of assertions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="putting-the-snapshot-into-c"></a>Putting the Snapshot into C#<a class="hash-link" href="#putting-the-snapshot-into-c" title="Direct link to heading">#</a></h2><p>Now if you&#x27;re writing tests in JavaScript or TypeScript then Jest already has your back with CLI snapshot generation and <code>shouldMatchSnapshot</code>. However getting to nearly the same place in C# is delightfully easy. What are we going to need?</p><p>First up, a serializer which can take your big bad data structures and render them as JSON. Also we&#x27;ll use it to rehydrate our data structure into an object ready for comparison. We&#x27;re going to use <a href="https://www.newtonsoft.com/json" target="_blank" rel="noopener noreferrer">Json.NET</a>.</p><p>Next up we need a way to compare our outputs with our rehydrated snapshots - we need a C# <code>shouldMatchSnapshot</code>. There&#x27;s many choices out there, but for my money <a href="https://fluentassertions.com" target="_blank" rel="noopener noreferrer">Fluent Assertions</a> is king of the hill.</p><p>Finally we&#x27;re going to need Snapshot, a little helper utility I put together:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cs codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using System.IO;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using Newtonsoft.Json;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">using Newtonsoft.Json.Serialization;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Test.Utilities {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static class Snapshot {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private static readonly JsonSerializer StubSerializer = new JsonSerializer { </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ContractResolver = new CamelCasePropertyNamesContractResolver(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            NullValueHandling = NullValueHandling.Ignore </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private static JsonTextWriter MakeJsonTextWriter(TextWriter sw) =&gt; new JsonTextWriter(sw) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Formatting = Formatting.Indented,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            IndentChar = &#x27; &#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Indentation = 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        /// &lt;summary&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        /// Make yourself some JSON! Usage looks like this:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        /// Stubs.Make($&quot;{System.AppDomain.CurrentDomain.BaseDirectory}..\\..\\..\\data.json&quot;, myData);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        /// &lt;/summary&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public static void Make&lt;T&gt;(string stubPath, T data) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            try {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (string.IsNullOrEmpty(stubPath))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    throw new ArgumentNullException(nameof(stubPath));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (data == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    throw new ArgumentNullException(nameof(data));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                using(var sw = new StreamWriter(stubPath))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                using(var writer = MakeJsonTextWriter(sw)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    StubSerializer.Serialize(writer, data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            } catch (Exception exc) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                throw new Exception($&quot;Failed to make {stubPath}&quot;, exc);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public static string Serialize&lt;T&gt;(T data) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            using (var sw = new StringWriter())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            using(var writer = MakeJsonTextWriter(sw)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                StubSerializer.Serialize(writer, data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                return sw.ToString();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public static string Load(string filename) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            var content = new StreamReader(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                File.OpenRead(filename)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ).ReadToEnd();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return content;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let&#x27;s look at the methods: <code>Make</code> and <code>Load</code>. Make is what we&#x27;re going to use to create our snapshots. Load is what we&#x27;re going to use to, uh, load our snapshots.</p><p>What does usage look like? Great question. Let&#x27;s go through the process of writing a C# snapshot test.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="taking-snapshot-for-a-spin"></a>Taking Snapshot for a Spin<a class="hash-link" href="#taking-snapshot-for-a-spin" title="Direct link to heading">#</a></h2><p>First of all, we&#x27;re going to need a method to test that outputs a data structure which is more than just a scalar value. Let&#x27;s use this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cs codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Leopard {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public string Name { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int Spots { get; set; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class LeopardService {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Leopard[] GetTheLeopards() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return new Leopard[] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            new Leopard { Spots = 42, Name = &quot;Nimoy&quot; },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            new Leopard { Spots = 900, Name = &quot;Dotty&quot; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Yes - our trusty <code>LeopardService</code>. As you can see, the <code>GetTheLeopards</code> method returns an array of <code>Leopard</code>s. For now, let&#x27;s write a test using <code>Snapshot</code>: (ours is an XUnit test; but <code>Snapshot</code> is agnostic of this)</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cs codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Fact]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public void GetTheLeopards_should_return_expected_Leopards() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Arrange</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var leopardService = new LeopardService();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Act</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var leopards = leopardService.GetTheLeopards();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // UNCOMMENT THE LINE BELOW *ONLY* WHEN YOU WANT TO GENERATE THE SNAPSHOT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Snapshot.Make($&quot;{System.AppDomain.CurrentDomain.BaseDirectory}..\\..\\..\\Snapshots\\leopardsSnapshot.json&quot;, leopards);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Assert</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var snapshotLeopards = JsonConvert.DeserializeObject&lt;leopard[]&gt;(Snapshot.Load(&quot;Snapshots/leopardsSnapshot.json&quot;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    snapshotLeopards.Should().BeEquivalentTo(leopards);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/leopard[]&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Before we run this for the first time we need to setup our testing project to be ready for snapshots. First of all we add a <code>Snapshot</code> folder to the test project. The we also add the following to the <code>.csproj</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-xml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">ItemGroup</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">Content</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">Include</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">Snapshots\**</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">CopyToOutputDirectory</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Always</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">CopyToOutputDirectory</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">Content</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">ItemGroup</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This includes the snapshots in the compile output for when tests are being run.</p><p>Now let&#x27;s run the test. It will generate a <code>leopardsSnapshot.json</code> file:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Nimoy&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;spots&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Dotty&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;spots&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">900</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>With our snapshot in place, we comment out the <code>Snapshot.Make...</code> line and we have a passing test. Let&#x27;s commit our code, push and go about our business.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="time-passes"></a>Time Passes...<a class="hash-link" href="#time-passes" title="Direct link to heading">#</a></h2><p>Someone decides that the implementation of <code>GetTheLeopards</code> needs to change. Defying expectations it seems that Dotty the leopard should now have 90 spots. I know... Business requirements, right?</p><p>If we make that change we&#x27;d ideally expect our trusty test to fail. Let&#x27;s see what happens:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">----- Test Execution Summary -----</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Leopard.Tests.Services.LeopardServiceTests.GetTheLeopards_should_return_expected_Leopards:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outcome: Failed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Error Message:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Expected item[1].Spots to be 90, but found 900.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Boom! We are protected!</p><p>Since this is a change we&#x27;re completely happy with we want to update our <code>leopardsSnapshot.json</code> file. We could make our test pass by manually updating the JSON. That&#x27;d be fine. But why work when you don&#x27;t have to? Let&#x27;s uncomment our <code>Snapshot.Make...</code> line and run the test the once.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Nimoy&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;spots&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Dotty&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;spots&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">90</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>That&#x27;s right, we have an updated snapshot! Minimal effort.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="next-steps"></a>Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">#</a></h2><p>This is a basic approach to getting the goodness of snapshot testing in C#. It could be refined further. To my mind the uncommenting / commenting of code is not the most elegant way to approach this and so there&#x27;s some work that could be done around this area.</p><p>Happy snapshotting!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/snapshot-testing">snapshot testing</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/c">c#</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/jest">jest</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/10/27/making-a-programmer">Making a Programmer</a></h2><div class="margin-vert--md"><time datetime="2018-10-27T00:00:00.000Z" class="blogPostDate_Ta7i">October 27, 2018  · 7 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>I recently had the good fortune to help run a coding bootcamp. The idea was simple: there are many people around us who are interested in programming but don&#x27;t know where to start. Let&#x27;s take some folk who do and share the knowledge.</p><p> The bootcamp went tremendously! (Well, I say that... Frankly I had a blast. 😀 )</p><p>Coding padawans walked in at the start with laptops and questions, and six weeks later they left with the groundwork of development experience. We ran a session for an hour during lunchtime once a week. Between that, people would have the opportunity to learn online, do exercises and reach out to the facilitators and their fellow apprentices for help.</p><p>We&#x27;d never done this before. We were student teachers; learning how to teach as we ran the course. So what did we do? Are you curious? Read on, Macduff!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="code-review"></a>Code Review<a class="hash-link" href="#code-review" title="Direct link to heading">#</a></h2><p>It&#x27;s worth saying now that we started our course with a plan: the plan was that we would be ready to change the plan. Or to put it another way, we were ready to pivot as we went.</p><p>We (by which I mean myself and the other course organisers) are interested in feedback. Sitting back and saying &quot;Hey! We did this thing.... What do you think about it?&quot; Because sometimes your plans are great. Do more of that hotness! But also, not all your ideas pan out... Maybe bail on those guys. Finally, never forget: other folk have brain tickling notions too.... We&#x27;re with Picasso on this: good artists copy; great artists steal.</p><p>We&#x27;re heavily invested in feedback in both what we build and how we build it. So we were totally going to apply this to doing something we&#x27;d never done before. So seized were we of this that we made feedback part of the session. For the last five minutes each week we&#x27;d run a short retrospective. We&#x27;d stick up happy, sad and &quot;meh&quot; emojis to the wall, hand out post-its and everyone got to stick up their thoughts.</p><p><a href="https://4.bp.blogspot.com/-iMa4bY7-wQA/W9Scd3s1QYI/AAAAAAAAMpY/IqdRIhTAuekj-5e7Yt4VOt55gtWmkbmTQCPcBGAYYCw/s1600/not-so-sure-about-this-feedback.jpg" target="_blank" rel="noopener noreferrer">![null](&lt;https://4.bp.blogspot.com/-iMa4bY7-wQA/W9Scd3s1QYI/AAAAAAAAMpY/IqdRIhTAuekj-5e7Yt4VOt55gtWmkbmTQCPcBGAYYCw/s400/not-so-sure-about-this-feedback.jpg&gt; =400x341)</a>From that we learned what was working, what wasn&#x27;t and when we were very lucky there were suggestions too. We listened to all the feedback and the next week&#x27;s session would be informed by what we&#x27;d just learned.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="merging-to-master"></a>Merging to Master<a class="hash-link" href="#merging-to-master" title="Direct link to heading">#</a></h2><p>So, what did we end up with? What did our coding bootcamp look like?</p><p>Well, to start each session we kicked off with an icebreaker. We very much wanted the sessions to be interactive experiences; we wanted them to feel playful and human. So an icebreaker was a good way to get things off on the right foot.</p><p>The IBs were connected with the subject at hand. For example: Human FizzBuzz. We took the classic interview question and applied it to wannabe coders. We explained the rules, and went round in a circle, each person was the next iteration of the loop. As each dev-in-training opened their mouths they had to say a number or &quot;Fizz&quot; or &quot;Buzz&quot; or &quot;FizzBuzz&quot;. (It turns out this is harder than you think; and makes for a surprisingly entertaining parlour game. I intend to do this at my next dinner party.)</p><p>After that we covered the rules of the game. (Yup, learning is a game and it&#x27;s a good &#x27;un.) Certainly the most important rule was this: <u>there are <strong><em>no</em></strong> stupid questions</u></p><p>. If people think there are, then they might be hesitant to ask. And any question benched is a learning opportunity lost. We don&#x27;t want that.</p><p>&quot;Ask any question!&quot; we said each week. Kudos to the people who have the courage to pipe up. We salute you! You&#x27;re likely putting voice to a common area of misunderstanding.</p><p>Then we&#x27;d move onto the main content. The initial plan was to make use of the excellent <a href="https://www.edx.org/learn/python" target="_blank" rel="noopener noreferrer">EdX Python course</a> Between each session our learners would do a module and then we&#x27;d come together and talk around that topic somewhat. Whilst this was a good initial plan it did make the learning experience somewhat passive and less interactive than we&#x27;d hoped.</p><p>One week we tried something different. It turns out that the amazing <a href="https://twitter.com/foldr" target="_blank" rel="noopener noreferrer">JMac</a> has quite the skill for writing programming exercises. Small coding challenges that people can tackle independently. JMac put together a <a href="https://repl.it/" target="_blank" rel="noopener noreferrer">repl.it</a> of exercises and encouraged the class to get stuck in. They did. So much so that at the end of the session it was hard to get everyone&#x27;s attention to let them know the session was over. They were in the zone. When we did finally disrupt their flow, the feedback was pretty unanimous: we&#x27;d hit paydirt.</p><p><a href="https://1.bp.blogspot.com/-vp4c9lrAXSc/W9Sc8-UeaRI/AAAAAAAAMpc/WtirbF3gNv0L1eni5eBVImjGA8DpQXJPgCLcBGAs/s1600/we-dug-this-feedback.jpg" target="_blank" rel="noopener noreferrer">![null](&lt;https://1.bp.blogspot.com/-vp4c9lrAXSc/W9Sc8-UeaRI/AAAAAAAAMpc/WtirbF3gNv0L1eni5eBVImjGA8DpQXJPgCLcBGAs/s400/we-dug-this-feedback.jpg&gt; =400x357)</a>Consequently, that was the format going onwards. JMac would come up with a number of exercises for the class. Wisely they were constructed so that they gently levelled up in terms of complexity as you went on. You&#x27;d get the dopamine hit of satisfaction as you did the earliest challenges that would give you the confidence to tackle the more complex later problems. If peeps got stuck they could ask someone to advise them, a facilitator or a peer. Or they could google it.... Like any other dev.</p><p>Having the chance to talk with others when you&#x27;re stuck is fantastic. You can talk through a problem. The act of doing that is a useful exercise. When you talk through a problem out loud you can unlock your understanding and often get to the point where you can tackle this yourself. This is <a href="https://en.wikipedia.org/wiki/Rubber_duck_debugging" target="_blank" rel="noopener noreferrer">rubber duck debugging</a>. Any dev does this in their everyday; it makes complete sense to have it as part of a coding bootcamp.</p><p>We learned that it was useful, very useful, to have repitition in the exercises. Repitition. Repitition. Repitition. As the exercises started each week they would typically begin by recapping and repeating the content covered the previous week. The best way to learn is to practice. It&#x27;s not for nothing the Karate Kid had to &quot;wax on, wax off&quot;.</p><p>Finally, we did this together. The course wasn&#x27;t run by one person; we had a gang! We had three facilitators who helped to run the sessions; JMac, Jonesy and myself. We also had the amazing <a href="https://twitter.com/janicewarden" target="_blank" rel="noopener noreferrer">Janice</a> who handled the general organisation and logistics. And made us laugh. A lot. This was obviously great from a camaraderie and sharing the load perspective. It turns out that having that number of facilitators in the session meant that everyone who needed help could get it. It&#x27;s worth noting that having more than a single facilitator is useful in terms of the dynamic it creates. You can bounce things off one another; you can use each other for examples and illustrations. You can crack each other up. Done well it reduces the instructor / learner divide and that breaking down of barriers is something worth seeking.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="rtm"></a>RTM<a class="hash-link" href="#rtm" title="Direct link to heading">#</a></h2><p>We&#x27;ve run a bootcamp once now. Where we are is informed by the experience we&#x27;ve just had. A different group of learners may well have resulted in a slightly different format; though I have a feeling not overly dissimilar. We feel pretty sure that what we&#x27;ve got is pretty solid. That said, just as the attendees are learning about development, we&#x27;re still learning about learning!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/coding-bootcamp">coding bootcamp</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/retrospective">retrospective</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/learning">learning</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/feedback">feedback</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/10/07/font-awesome-brand-icons-react">Brand New Fonting Awesomeness</a></h2><div class="margin-vert--md"><time datetime="2018-10-07T00:00:00.000Z" class="blogPostDate_Ta7i">October 7, 2018  · 2 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>Love me some <a href="https://fontawesome.com" target="_blank" rel="noopener noreferrer">Font Awesome</a>. Absolutely wonderful. However, I came a cropper when following the instructions <a href="https://fontawesome.com/how-to-use/on-the-web/using-with/react" target="_blank" rel="noopener noreferrer">on using the all new Font Awesome 5 with React</a>. The instructions for standard icons work <em>fine</em>. But if you want to use brand icons then this does not help you out much. There&#x27;s 2 problems:</p><ol><li>Font Awesome&#x27;s brand icons are not part of <code>&lt;a href=&quot;https://www.npmjs.com/package/@fortawesome/free-solid-svg-icons&quot;&gt;@fortawesome/free-solid-svg-icons&lt;/a&gt;</code> package</li><li>The method of icon usage illustrated (i.e. with the <code>FontAwesomeIcon</code> component) doesn&#x27;t work. It doesn&#x27;t render owt.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="brand-me-up-buttercup"></a>Brand Me Up Buttercup<a class="hash-link" href="#brand-me-up-buttercup" title="Direct link to heading">#</a></h2><p>You want brands? Well you need the <code>&lt;a href=&quot;https://www.npmjs.com/package/@fortawesome/free-brands-svg-icons&quot;&gt;@fortawesome/free-brands-svg-icons&lt;/a&gt;</code>. Obvs, right?</p><div class="mdxCodeBlock_1zKU">yarn add @fortawesome/fontawesome-svg-core yarn add @fortawesome/free-brands-svg-icons yarn add @fortawesome/react-fontawesome</div><p>Now usage:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-jsx codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> React </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> FontAwesomeIcon </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@fortawesome/react-fontawesome&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> faReact </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@fortawesome/free-brands-svg-icons&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">Framework</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Favorite Framework</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">FontAwesomeIcon</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">icon</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript" style="color:rgb(255, 85, 114)">faReact</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Here we&#x27;ve ditched the &quot;library / magic-string&quot; approach from the documentation for one which explicitly imports and uses the required icons. I suspect this will be good for tree-shaking as well but, hand-on-heart, I haven&#x27;t rigorously tested that. I&#x27;m not sure why the approach I&#x27;m using isn&#x27;t documented actually. Mysterious! I&#x27;ve seen no ill-effects from using it but perhaps YMMV. Proceed with caution...</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="update-it-is-documented"></a>Update: It is documented!<a class="hash-link" href="#update-it-is-documented" title="Direct link to heading">#</a></h2><p>Yup - information on this approach is out there; but it&#x27;s less obvious than you might hope. <a href="https://github.com/FortAwesome/react-fontawesome#explicit-import" target="_blank" rel="noopener noreferrer">Read all about it here.</a> For what it&#x27;s worth, the explicit import approach seems to be playing second fiddle to the library / magic-string one. I&#x27;m not too sure why. For my money, explicit imports are clearer, less prone to errors and better setup for optimisation. Go figure...</p><p>Feel free to set me straight in the comments!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/brand-icons">brand icons</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/react">React</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/font-awesome">font awesome</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/09/23/ts-loader-project-references-first-blood">ts-loader Project References: First Blood</a></h2><div class="margin-vert--md"><time datetime="2018-09-23T00:00:00.000Z" class="blogPostDate_Ta7i">September 23, 2018  · 4 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>So <a href="https://www.typescriptlang.org/docs/handbook/project-references.html" target="_blank" rel="noopener noreferrer">project references</a> eh? They shipped with <a href="https://blogs.msdn.microsoft.com/typescript/2018/07/30/announcing-typescript-3-0/#project-references" target="_blank" rel="noopener noreferrer">TypeScript 3</a>. We&#x27;ve just shipped initial support for project references in <a href="https://github.com/TypeStrong/ts-loader/releases/tag/v5.2.0" target="_blank" rel="noopener noreferrer"><code>ts-loader v5.2.0</code></a>. All the hard work was done by the amazing <a href="https://twitter.com/atcb" target="_blank" rel="noopener noreferrer">Andrew Branch</a>. In fact I&#x27;d recommend taking a gander at <a href="https://github.com/TypeStrong/ts-loader/pull/817" target="_blank" rel="noopener noreferrer">the PR</a>. Yay Andrew!</p><p> This post will take us through the nature of the support for project references in ts-loader now and what we hope the future will bring. It <strike>rips off shamelessly</strike></p><p> borrows from the <a href="https://github.com/TypeStrong/ts-loader#projectreferences-boolean-defaultfalse" target="_blank" rel="noopener noreferrer"><code>README.md</code></a> documentation that Andrew wrote as part of the PR. Because I am not above stealing.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="tldr"></a>TL;DR<a class="hash-link" href="#tldr" title="Direct link to heading">#</a></h2><p>Using project references currently requires building referenced projects outside of ts-loader. We don’t want to keep it that way, but we’re releasing what we’ve got now. To try it out, you’ll need to pass <code>projectReferences: true</code> to <code>loaderOptions</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="like-tsc-but-not-like-tsc---build"></a>Like <code>tsc</code>, but <em>not</em> like <code>tsc --build</code><a class="hash-link" href="#like-tsc-but-not-like-tsc---build" title="Direct link to heading">#</a></h2><p>ts-loader has partial support for <a href="https://www.typescriptlang.org/docs/handbook/project-references.html" target="_blank" rel="noopener noreferrer">project references</a> in that it will <em>load</em> dependent composite projects that are already built, but will not currently <em>build/rebuild</em> those upstream projects. The best way to explain exactly what this means is through an example. Say you have a project with a project reference pointing to the <code>lib/</code> directory:</p><div class="mdxCodeBlock_1zKU">tsconfig.json app.ts lib/ tsconfig.json niftyUtil.ts</div><p>And we’ll assume that the root <code>tsconfig.json</code> has <code>{ &quot;references&quot;: { &quot;path&quot;: &quot;lib&quot; } }</code>, which means that any import of a file that’s part of the <code>lib</code> sub-project is treated as a reference to another project, not just a reference to a TypeScript file. Before discussing how ts-loader handles this, it’s helpful to review at a really basic level what <code>tsc</code> itself does here. If you were to run <code>tsc</code> on this tiny example project, the build would fail with the error:</p><div class="mdxCodeBlock_1zKU">error TS6305: Output file &#x27;lib/niftyUtil.d.ts&#x27; has not been built from source file &#x27;lib/niftyUtil.ts&#x27;.</div><p>Using project references actually instructs <code>tsc</code><em>not</em> to build anything that’s part of another project from source, but rather to look for any <code>.d.ts</code> and <code>.js</code> files that have already been generated from a previous build. Since we’ve never built the project in <code>lib</code> before, those files don’t exist, so building the root project fails. Still just thinking about how <code>tsc</code> works, there are two options to make the build succeed: either run <code>tsc -p lib/tsconfig.json</code><em>first</em>, or simply run <code>tsc --build</code>, which will figure out that <code>lib</code> hasn’t been built and build it first for you.</p><p>Ok, so how is that relevant to ts-loader? Because the best way to think about what ts-loader does with project references is that it acts like <code>tsc</code>, but <em>not</em> like <code>tsc --build</code>. If you run ts-loader on a project that’s using project references, and any upstream project hasn’t been built, you’ll get the exact same <code>error TS6305</code> that you would get with <code>tsc</code>. If you modify a source file in an upstream project and don’t rebuild that project, <code>ts-loader</code> won’t have any idea that you’ve changed anything—it will still be looking at the output from the last time you <em>built</em> that file.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="hey-dont-you-think-that-sounds-kind-of-useless-and-terrible"></a>“Hey, don’t you think that sounds kind of useless and terrible?”<a class="hash-link" href="#hey-dont-you-think-that-sounds-kind-of-useless-and-terrible" title="Direct link to heading">#</a></h2><p>Well, sort of. You can consider it a work-in-progress. It’s true that on its own, as of today, ts-loader doesn’t have everything you need to take advantage of project references in webpack. In practice, though, <em>consuming</em> upstream projects and <em>building</em> upstream projects are somewhat separate concerns. Building them will likely come in a future release. For background, see the <a href="https://github.com/TypeStrong/ts-loader/issues/815" target="_blank" rel="noopener noreferrer">original issue</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="outdir-windows-problemo"></a><code>outDir</code> Windows problemo.<a class="hash-link" href="#outdir-windows-problemo" title="Direct link to heading">#</a></h2><p>At the moment, composite projects built using the <a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" target="_blank" rel="noopener noreferrer"><code>outDir</code> compiler option</a> cannot be consumed using ts-loader on Windows. If you try to, ts-loader throws a &quot;<code>has not been built from source file</code>&quot; error. <a href="https://github.com/TypeStrong/ts-loader/pull/817#issuecomment-422245998" target="_blank" rel="noopener noreferrer">You can see Andrew and I puzzling over it in the PR.</a> We don&#x27;t know why yet; it&#x27;s possible there&#x27;s a bug in <code>tsc</code>. It&#x27;s more likely there&#x27;s a bug in <code>ts-loader</code>. Hopefully it&#x27;s going to get solved at some point. (Hey, maybe you&#x27;re the one to solve it!) Either way, we didn&#x27;t want to hold back from releasing. So if you&#x27;re building on Windows then avoid building <code>composite</code> projects using <code>outDir</code>.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/type-script">TypeScript</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/project-references">project references</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/ts-loader">ts-loader</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/webpack">Webpack</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/09/15/ivan-drago-and-definitely-typed">Ivan Drago and Definitely Typed</a></h2><div class="margin-vert--md"><time datetime="2018-09-15T00:00:00.000Z" class="blogPostDate_Ta7i">September 15, 2018  · 5 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>This a tale of things that are and things that aren&#x27;t. It&#x27;s a tale of semantic versioning, the lack thereof and heartbreak. It&#x27;s a story of terror and failing builds. But it has a bittersweet ending wherein our heroes learn a lesson and understand the need for compromise. We all come out better and wiser people. Hopefully there&#x27;s something for everybody; let&#x27;s start with an exciting opener and see where it goes...</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="definitely-typed"></a>Definitely Typed<a class="hash-link" href="#definitely-typed" title="Direct link to heading">#</a></h2><p>This is often the experience people have of using type definitions from Definitely Typed:</p><p><a href="https://1.bp.blogspot.com/-mG6pw3oJA4E/W5tD5vgfD4I/AAAAAAAAMQQ/upV1w2nJw1whI7MGp9HI5pniFEbVTJNxACPcBGAYYCw/s1600/i-must-break-you.jpg" target="_blank" rel="noopener noreferrer"><img src="https://1.bp.blogspot.com/-mG6pw3oJA4E/W5tD5vgfD4I/AAAAAAAAMQQ/upV1w2nJw1whI7MGp9HI5pniFEbVTJNxACPcBGAYYCw/s1600/i-must-break-you.jpg" alt="null"></a>Specifically, people are used to the idea of semantic versioning and expect it from types published to npm by Definitely Typed. They wait in vain. <a href="https://blog.johnnyreilly.com/2017/02/typescript-types-and-repeatable-builds.html" target="_blank" rel="noopener noreferrer">I&#x27;ve written before about the Definitely Typed / @types semantic version compromise.</a> And I wanted to talk about it a little further as (watching the issues raised on DT) I don&#x27;t think the message has quite got out there. To summarise:</p><ol><li><p>npm is built on top of <a href="http://semver.org/" target="_blank" rel="noopener noreferrer">semantic versioning</a> and they <a href="https://docs.npmjs.com/getting-started/semantic-versioning" target="_blank" rel="noopener noreferrer">take it seriously</a>. When a package is published it should be categorised as a major release (breaking changes), a minor release (extra functionality which is backwards compatible) or a patch release (backwards compatible bug fixes).</p></li><li><p>Definitely Typed publishes type definitions to npm under the <code>@types</code> namespace</p></li><li><p>To make consumption of type definitions easier, the versioning of a type definition package will seek to emulate the versioning of the npm package it supports. For example, right now <code>&lt;a href=&quot;https://www.npmjs.com/package/react-router&quot;&gt;react-router&lt;/a&gt;</code>&#x27;s latest version is <code>4.3.1</code>. The corresponding type definition <code>&lt;a href=&quot;https://www.npmjs.com/package/@types/react-router&quot;&gt;@types/react-router&lt;/a&gt;</code>&#x27;s latest version is <code>4.0.31</code>. (It&#x27;s fairly common for type definition versions to lag behind the package they type.)</p><p>If there&#x27;s a breaking change to the <code>react-router</code> type definition then the new version published will have a version number that begins <code>&quot;4.0.&quot;</code>. If you are relying on semantic versioning this will break you.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="i-couldnt-help-but-notice-your-pain"></a>I Couldn&#x27;t Help But Notice Your Pain<a class="hash-link" href="#i-couldnt-help-but-notice-your-pain" title="Direct link to heading">#</a></h2><p>If you&#x27;re reading this and can&#x27;t quite believe that @types would be so inconsiderate as to break the conventions of the ecosystem it lives in, I understand. But hopefully you can see there are reasons for this. In the end, being able to use npm as a delivery mechanism for versioned type definitions associated with another package has a cost; that cost is semantic versioning for the type definitions themselves. It wasn&#x27;t a choice taken lightly; it&#x27;s a pragmatic compromise.</p><p>&quot;But what about my failing builds? Fine, people are going to change type definitions, but why should I burn because of their choices?&quot;</p><p>Excellent question. Truly. Well here&#x27;s my advice: don&#x27;t expect semantic versioning where there is none. Use specific package versions. You can do that directly with your <code>package.json</code>. For example replace something like this: <code>&quot;@types/react-router&quot;: &quot;^4.0.0&quot;</code> with a specific version number: <code>&quot;@types/react-router&quot;: &quot;4.0.31&quot;</code>. With this approach it&#x27;s a specific activity to upgrade your type definitions. A chore if you will; but a chore that guarantees builds will not fail unexpectedly due to changing type defs.</p><p>My own personal preference is <a href="https://yarnpkg.com/lang/en/" target="_blank" rel="noopener noreferrer">yarn</a>. Mother, I&#x27;m in love with a <code>yarn.lock</code> file. It is the alternative npm client that came out of Facebook. It pins the exact versions of all packages used in your <code>yarn.lock</code> file and guarantees to install the same versions each time. Problem solved; and it even allows me to keep the semantic versioning in my <code>package.json</code> as is.</p><p>This has some value in that when I upgrade I probably want to upgrade to a newer version following the semantic versioning convention. I should just expect that I&#x27;ll need to check valid compilation when I do so. yarn even has it&#x27;s own built in utility that tells you when things are out of date: <code>yarn outdated</code>:</p><p><a href="https://1.bp.blogspot.com/-CMAE-6BZQjQ/W5yfpzZG_iI/AAAAAAAAMRU/GkH9ZDr_SmMIzLwO1dlwS0Y0bVqWkhXyQCPcBGAYYCw/s1600/Screenshot%2B2018-09-15%2B06.56.20.png" target="_blank" rel="noopener noreferrer">![null](&lt;https://1.bp.blogspot.com/-CMAE-6BZQjQ/W5yfpzZG_iI/AAAAAAAAMRU/GkH9ZDr_SmMIzLwO1dlwS0Y0bVqWkhXyQCPcBGAYYCw/s640/Screenshot%2B2018-09-15%2B06.56.20.png&gt; =640x159)</a>So lovely</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="you-were-already-broken---i-just-showed-you-how"></a>You Were Already Broken - I Just Showed You How<a class="hash-link" href="#you-were-already-broken---i-just-showed-you-how" title="Direct link to heading">#</a></h2><p>Before I finish I wanted to draw out one reason why breaking changes can be a reason for happiness. Because sometimes your code is wrong. An update to a type definition may highlight that. This is analogous to when the TypeScript compiler ships a new version. When I upgrade to a newer version of TypeScript it lights up errors in my codebase that I hadn&#x27;t spotted. Yay compiler!</p><p>An example of this is <a href="https://github.com/DefinitelyTyped/DefinitelyTyped/pull/28868" target="_blank" rel="noopener noreferrer">a PR I submitted to DefinitelyTyped earlier this week</a>. This PR changed how <code>react-router</code> models the parameters of a <code>Match</code>. Until now, an object was expected; the user could define any object they liked. However, <code>react-router</code> will only produce <code>string</code> values for a parameter. <a href="https://github.com/ReactTraining/react-router/blob/34ff1f8077d95edf01e9d5ca8ea4708b8d0290e2/packages/react-router/modules/matchPath.js#L36" target="_blank" rel="noopener noreferrer">If you look at the underlying code it&#x27;s nothing more than an <code>exec</code> on a regular expression.</a></p><p>My PR enforces this at type level by changing this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ts codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">match</span><span class="token class-name operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token class-name constant" style="color:rgb(130, 170, 255)">P</span><span class="token class-name operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  params</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">P</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>To this</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ts codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">match</span><span class="token class-name operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token class-name maybe-class-name" style="color:rgb(255, 203, 107)">Params</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name keyword" style="color:rgb(255, 203, 107);font-style:italic">extends</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token class-name constant" style="color:rgb(130, 170, 255)">K</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name keyword" style="color:rgb(255, 203, 107);font-style:italic">in</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name keyword" style="color:rgb(255, 203, 107);font-style:italic">keyof</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name maybe-class-name" style="color:rgb(255, 203, 107)">Params</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token class-name operator" style="color:rgb(137, 221, 255)">?</span><span class="token class-name operator" style="color:rgb(137, 221, 255)">:</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name builtin" style="color:rgb(130, 170, 255)">string</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name operator" style="color:rgb(137, 221, 255)">=</span><span class="token class-name" style="color:rgb(255, 203, 107)"> </span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token class-name operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  params</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>So any object definition supplied must have <code>string</code> values (and you don&#x27;t actually need to supply an object definition; that&#x27;s optional now).</p><p>I expected this PR to break people <a href="https://github.com/DefinitelyTyped/DefinitelyTyped/issues/28894" target="_blank" rel="noopener noreferrer">and it did</a>. But this is a useful break. If they were relying upon their parameters to be types other than strings they would be experiencing some unexpected behaviour. In fact, it&#x27;s exactly this that prompted my PR in the first place. A colleague had defined his parameters as <code>number</code>s and couldn&#x27;t understand why they weren&#x27;t behaving like <code>number</code>s. Because they weren&#x27;t <code>number</code>s! And wonderfully, this will now be caught at compile time; not runtime. Yay!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/react-router">react-router</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/definitely-typed">DefinitelyTyped</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/ivan-drago">Ivan Drago</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/type-script">TypeScript</a><a class="margin-horiz--sm" href="/blog.johnnyreilly.com/tags/semantic-versioning">semantic versioning</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/08/21/killing-relative-paths-with-typescript-and">💣ing Relative Paths with TypeScript and webpack</a></h2><div class="margin-vert--md"><time datetime="2018-08-21T00:00:00.000Z" class="blogPostDate_Ta7i">August 21, 2018  · 3 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>I write a lot of TypeScript. Because I like modularity, I split up my codebases into discreet modules and <code>import</code> from them as necessary.</p><p> Take a look at this <code>import</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ts codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(137, 221, 255)">*</span><span class="token imports"> </span><span class="token imports keyword" style="font-style:italic">as</span><span class="token imports"> utils</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;../../../../../../../shared/utils&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now take a look at this import:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ts codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(137, 221, 255)">*</span><span class="token imports"> </span><span class="token imports keyword" style="font-style:italic">as</span><span class="token imports"> utils</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;shared/utils&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Which do you prefer? If the answer was &quot;the first&quot; then read no further. You have all you need, go forth and be happy. If the answer was &quot;the second&quot; then stick around; I can help!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="typescript"></a>TypeScript<a class="hash-link" href="#typescript" title="Direct link to heading">#</a></h2><p>There&#x27;s been a solution for this in TypeScript-land for some time. You can read the detail <a href="https://www.typescriptlang.org/docs/handbook/module-resolution.html#path-mapping" target="_blank" rel="noopener noreferrer">in the &quot;path mapping&quot; docs here</a>.</p><p>Let&#x27;s take a slightly simpler example; we have a folder structure that looks like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-console codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">projectRoot </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">├── components </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│ └── page.tsx (imports &#x27;../shared/utils&#x27;) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">├── shared </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│ ├── folder1 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│ └── folder2 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│ └── utils.ts </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">└── tsconfig.json</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We would like <code>page.tsx</code> to import <code>&#x27;shared/utils&#x27;</code> instead of <code>&#x27;../shared/utils&#x27;</code>. We can, if we augment our <code>tsconfig.json</code> with the following properties:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;compilerOptions&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;baseUrl&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;.&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;paths&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token property">&quot;components/*&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;components/*&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token property">&quot;shared/*&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;shared/*&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Then we can use option 2. We can happily write:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ts codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(137, 221, 255)">*</span><span class="token imports"> </span><span class="token imports keyword" style="font-style:italic">as</span><span class="token imports"> utils</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;shared/utils&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>My code compiles, yay.... Ship it!</p><p>Let&#x27;s not get over-excited. Actually, we&#x27;re only part-way there; you can compile this code with the TypeScript compiler.... But is that enough?</p><p>I bundle my TypeScript with <a href="https://github.com/TypeStrong/ts-loader" target="_blank" rel="noopener noreferrer">ts-loader</a> and webpack. If I try and use my new exciting import statement above with my build system then disappointment is in my future. webpack will be all like &quot;import whuuuuuuuut?&quot;</p><p>You see, webpack doesn&#x27;t know what we told the TypeScript compiler in the <code>tsconfig.json</code>. Why would it? It was our little secret.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="webpack-resolvealias-to-the-rescue"></a>webpack <code>resolve.alias</code> to the rescue!<a class="hash-link" href="#webpack-resolvealias-to-the-rescue" title="Direct link to heading">#</a></h2><p>This same functionality has existed in webpack for a long time; actually much longer than it has existed in TypeScript. It&#x27;s the <a href="https://webpack.js.org/configuration/resolve/#resolve-alias" target="_blank" rel="noopener noreferrer"><code>resolve.alias</code></a> functionality.</p><p>So, looking at that I should be able to augment my <code>webpack.config.js</code> like so:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  resolve</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    alias</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      components</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">cwd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;components/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      shared</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">cwd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;shared/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>And now both webpack and TypeScript are up to speed with how to resolve modules.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dry-with-the-tsconfig-paths-webpack-plugin"></a>DRY with the <a href="https://github.com/dividab/tsconfig-paths-webpack-plugin" target="_blank" rel="noopener noreferrer"><code>tsconfig-paths-webpack-plugin</code></a><a class="hash-link" href="#dry-with-the-tsconfig-paths-webpack-plugin" title="Direct link to heading">#</a></h2><p>When I look at the <code>tsconfig.json</code> and the <code>webpack.config.js</code> something occurs to me: I don&#x27;t like to repeat myself. As well as that, I don&#x27;t like to repeat myself. It&#x27;s so... Repetitive.</p><p>The declarations you make in the <code>tsconfig.json</code> are re-stated in the <code>webpack.config.js</code>. Who wants to maintain two sets of code where one would do? Not me.</p><p>Fortunately, you don&#x27;t have to. There&#x27;s the <a href="https://github.com/dividab/tsconfig-paths-webpack-plugin" target="_blank" rel="noopener noreferrer"><code>tsconfig-paths-webpack-plugin</code></a> for webpack which will do the job for you. You can replace your verbose <code>resolve.alias</code> with this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ts codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  resolve</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(255, 203, 107)">TsconfigPathsPlugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/*configFile: &quot;./path/to/tsconfig.json&quot; */</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This does the hard graft of reading your <code>tsconfig.json</code> and translating path mappings into webpack <code>alias</code>es. From this point forward, you need only edit the <code>tsconfig.json</code> and everything else will just work.</p><p>Thanks to <a href="https://github.com/jonaskello" target="_blank" rel="noopener noreferrer">Jonas Kello</a>, author of the plugin; it&#x27;s tremendous! Thanks also to <a href="https://twitter.com/TheLarkInn" target="_blank" rel="noopener noreferrer">Sean Larkin</a> and <a href="https://github.com/s-panferov" target="_blank" rel="noopener noreferrer">Stanislav Panferov</a> (of <a href="https://github.com/s-panferov/awesome-typescript-loader" target="_blank" rel="noopener noreferrer">awesome-typescript-loader</a>) who together worked on the original plugin that I understand the <code>tsconfig-paths-webpack-plugin</code> is based on. Great work!</p></section></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog.johnnyreilly.com/2018/07/28/configuring-docker-azure-web-app-containers">Docker and Configuration on Azure Web App for Containers: Whither Colons?</a></h2><div class="margin-vert--md"><time datetime="2018-07-28T00:00:00.000Z" class="blogPostDate_Ta7i">July 28, 2018  · 2 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/1010525?s=400&amp;u=294033082cfecf8ad1645b4290e362583b33094a&amp;v=4" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noreferrer noopener">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>App Services have long been a super simple way to spin up a web app in Azure. The barrier to entry is low, maintenance is easy. It just works. App Services recently got a turbo boost in the form of <a href="https://docs.microsoft.com/en-us/azure/app-service/containers/app-service-linux-intro" target="_blank" rel="noopener noreferrer">Azure App Service on Linux</a>. Being able to deploy to Linux is exciting enough; but the real reason this is notable because <a href="https://docs.microsoft.com/en-us/azure/app-service/containers/tutorial-custom-docker-image" target="_blank" rel="noopener noreferrer">you can deploy Docker images that will be run as app services</a>.</p><p> I cannot over-emphasise just how easy this makes getting a Docker image into Production. Yay Azure!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="the-mystery-of-configuration"></a>The Mystery of Configuration<a class="hash-link" href="#the-mystery-of-configuration" title="Direct link to heading">#</a></h2><p>Applications need configuration. ASP.Net Core applications are typically configured by an <code>appsettings.json</code> file which might look like so:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;Parent&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;ChildOne&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;I&#x27;m a little teapot&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;ChildTwo&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Short and stout&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>With a classic App Service you could override a setting in the <code>appsettings.json</code> by updating &quot;Application settings&quot; within the Azure portal. You&#x27;d do this in the style of creating an Application setting called <code>Parent:ChildOne</code> or <code>Parent:ChildTwo</code>. To be clear: using colons to target a specific piece of config.</p><p><a href="https://3.bp.blogspot.com/-LUlgZrW9Yc0/W1wg5AbUQNI/AAAAAAAALVU/NeLfdpy7MOI0tAOX6EN-JH3SKDBwbbflACPcBGAYYCw/s1600/appservice_classic.png" target="_blank" rel="noopener noreferrer">![null](&lt;https://3.bp.blogspot.com/-LUlgZrW9Yc0/W1wg5AbUQNI/AAAAAAAALVU/NeLfdpy7MOI0tAOX6EN-JH3SKDBwbbflACPcBGAYYCw/s640/appservice_classic.png&gt; =640x336)</a>You can read about this approach <a href="https://blogs.msdn.microsoft.com/waws/2018/06/12/asp-net-core-settings-for-azure-app-service/" target="_blank" rel="noopener noreferrer">here</a>. Now there&#x27;s something I want you to notice; consider the colons below:</p><p><a href="https://2.bp.blogspot.com/-0YSRmySfNc4/W1whJuEieaI/AAAAAAAALVc/k1zloq14lzASVQL6HjHCk-zzDTD2a8LAwCLcBGAs/s1600/appservice_colons_fine.png" target="_blank" rel="noopener noreferrer">![null](&lt;https://2.bp.blogspot.com/-0YSRmySfNc4/W1whJuEieaI/AAAAAAAALVc/k1zloq14lzASVQL6HjHCk-zzDTD2a8LAwCLcBGAs/s640/appservice_colons_fine.png&gt; =640x105)</a>If you try and follow the same steps when you&#x27;re using Web App for Containers / i.e. <a href="https://docs.microsoft.com/en-us/azure/app-service/containers/app-service-linux-intro" target="_blank" rel="noopener noreferrer">a Docker image deployed to an Azure App Service on Linux </a> you <strong>cannot</strong> use colons:</p><p><a href="https://2.bp.blogspot.com/-hPNAcxRce0o/W1whYT9tINI/AAAAAAAALVg/YCCKzRE4E8opV5VZYmVFmSiOBLRWbep1ACLcBGAs/s1600/appservice_container_colons_bad.png" target="_blank" rel="noopener noreferrer">![null](&lt;https://2.bp.blogspot.com/-hPNAcxRce0o/W1whYT9tINI/AAAAAAAALVg/YCCKzRE4E8opV5VZYmVFmSiOBLRWbep1ACLcBGAs/s640/appservice_container_colons_bad.png&gt; =640x65)</a>When you hover over the error you see this message: <code>This field can only contain letters, numbers (0-9), periods (&quot;.&quot;), and underscores (&quot;_&quot;)</code>. Using <code>.</code> does not work alas.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="what-do-i-do"></a>What do I do?<a class="hash-link" href="#what-do-i-do" title="Direct link to heading">#</a></h2><p>So it turns out you just can&#x27;t configure App Services on Linux.</p><p>Jokes!</p><p>No, of course you can and here I can help. After more experimentation than I&#x27;d like to admit I happened upon the answer. Here it is:</p><p>Where you use <code>:</code> on a classic App Service, you should use a <code>__</code> (double underscore) on an App Service with containers. So <code>Parent__ChildOne</code> instead of <code>Parent:ChildOne</code>. It&#x27;s as simple as that.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="why-is-it-like-this"></a>Why is it like this?<a class="hash-link" href="#why-is-it-like-this" title="Direct link to heading">#</a></h2><p>Honestly? No idea. I can&#x27;t find any information on the matter. Let me know if you find out.</p></section></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog.johnnyreilly.com/page/5"><div class="pagination-nav__label">« Newer Entries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog.johnnyreilly.com/page/7"><div class="pagination-nav__label">Older Entries »</div></a></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/blog.johnnyreilly.com/styles.e251ffc4.js"></script>
<script src="/blog.johnnyreilly.com/runtime~main.17090397.js"></script>
<script src="/blog.johnnyreilly.com/main.76845b2c.js"></script>
<script src="/blog.johnnyreilly.com/1.32932134.js"></script>
<script src="/blog.johnnyreilly.com/2.7bb643e8.js"></script>
<script src="/blog.johnnyreilly.com/a6aa9e1f.f671cbae.js"></script>
<script src="/blog.johnnyreilly.com/c3b5bd8c.b09f7905.js"></script>
<script src="/blog.johnnyreilly.com/012d4097.18bab675.js"></script>
<script src="/blog.johnnyreilly.com/cb8d7bac.ce560a11.js"></script>
<script src="/blog.johnnyreilly.com/d7a60416.16290ba7.js"></script>
<script src="/blog.johnnyreilly.com/3c656591.945fd274.js"></script>
<script src="/blog.johnnyreilly.com/8e0d145b.5dae1524.js"></script>
<script src="/blog.johnnyreilly.com/0a977c03.08e9abe0.js"></script>
<script src="/blog.johnnyreilly.com/4424fda7.df76d9f9.js"></script>
<script src="/blog.johnnyreilly.com/78d410a3.4b6e4ad2.js"></script>
<script src="/blog.johnnyreilly.com/e415f8a6.3775f66d.js"></script>
<script src="/blog.johnnyreilly.com/8fb3131e.3a97ca31.js"></script>
<script src="/blog.johnnyreilly.com/183b754e.58338be8.js"></script>
</body>
</html>