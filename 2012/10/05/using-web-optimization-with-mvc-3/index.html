<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51754530-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="icon" href="/img/favicon/profile.jpg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/favicon/apple-touch-icon.png"><title data-react-helmet="true">I CAN MAKE THIS WORK</title><meta data-react-helmet="true" name="description" content="A while ago I wrote about optimally serving up JavaScript in web applications. I mentioned that Microsoft had come up with a NuGet package called Microsoft ASP.NET Web Optimization which could help with that by minifying and bundling CSS and JavaScript. At the time I was wondering if I would be able to to use this package with pre-existing MVC 3 projects (given that the package had been released together with MVC 4). Happily it turns out you can. But it&#x27;s not quite as straightforward as I might have liked so I&#x27;ve documented how to get going with this here..."><meta data-react-helmet="true" property="og:description" content="A while ago I wrote about optimally serving up JavaScript in web applications. I mentioned that Microsoft had come up with a NuGet package called Microsoft ASP.NET Web Optimization which could help with that by minifying and bundling CSS and JavaScript. At the time I was wondering if I would be able to to use this package with pre-existing MVC 3 projects (given that the package had been released together with MVC 4). Happily it turns out you can. But it&#x27;s not quite as straightforward as I might have liked so I&#x27;ve documented how to get going with this here..."><meta data-react-helmet="true" property="og:url" content="https://blog.johnnyreilly.com/2012/10/05/using-web-optimization-with-mvc-3"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="I CAN MAKE THIS WORK"><meta data-react-helmet="true" property="og:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" name="twitter:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blog.johnnyreilly.com/2012/10/05/using-web-optimization-with-mvc-3"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/2012/10/05/using-web-optimization-with-mvc-3" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/2012/10/05/using-web-optimization-with-mvc-3" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.105de97d.css">
<link rel="preload" href="/assets/js/styles.29bd7c80.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.82d802bb.js" as="script">
<link rel="preload" href="/assets/js/main.c527f95b.js" as="script">
<link rel="preload" href="/assets/js/1.c330b6a7.js" as="script">
<link rel="preload" href="/assets/js/2.9dac0846.js" as="script">
<link rel="preload" href="/assets/js/ccc49370.86a8a52f.js" as="script">
<link rel="preload" href="/assets/js/c3b5bd8c.dd098e6e.js" as="script">
<link rel="preload" href="/assets/js/8890ac7a.85d30348.js" as="script">
<link rel="preload" href="/assets/js/fe3d2add.408ead11.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a><a class="navbar__item navbar__link" href="/about">About</a><a class="navbar__item navbar__link" href="/blog-archive">Blog Archive</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">I CAN MAKE THIS WORK</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/about">About</a></li><li class="menu__list-item"><a class="menu__link" href="/blog-archive">Blog Archive</a></li><li class="menu__list-item"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="menu__link">Twitter</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">Recent posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/04/20/ts-loader-goes-webpack-5">ts-loader goes webpack 5</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/04/10/hello-world-bicep">Hello World Bicep</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/03/23/bicep-meet-azure-pipelines-2">Bicep meet Azure Pipelines 2</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/03/20/bicep-meet-azure-pipelines">Bicep meet Azure Pipelines</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/03/17/rss-update-we-moved-to-docusaurus">RSS update; we moved to Docusaurus</a></li></ul></div></div><main class="col col--7"><article><header><h1 class="margin-bottom--sm blogPostTitle_GeHD">Using Web Optimization with MVC 3</h1><div class="margin-vert--md"><time datetime="2012-10-05T00:00:00.000Z" class="blogPostDate_fNvV">October 5, 2012 Â· 4 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer">John Reilly</a></h4><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>A while ago I <a href="http://icanmakethiswork.blogspot.com/2012/06/how-im-structuring-my-javascript-in-web.html#WebOptimization" target="_blank" rel="noopener noreferrer">wrote</a> about optimally serving up JavaScript in web applications. I mentioned that Microsoft had come up with a NuGet package called <a href="http://nuget.org/packages/Microsoft.AspNet.Web.Optimization" target="_blank" rel="noopener noreferrer">Microsoft ASP.NET Web Optimization</a> which could help with that by minifying and bundling CSS and JavaScript. At the time I was wondering if I would be able to to use this package with pre-existing MVC 3 projects (given that the package had been released together with MVC 4). Happily it turns out you can. But it&#x27;s not quite as straightforward as I might have liked so I&#x27;ve documented how to get going with this here...</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getting-the-basics-in-place"></a>Getting the Basics in Place<a class="hash-link" href="#getting-the-basics-in-place" title="Direct link to heading">#</a></h2><p>To keep it simple I&#x27;m going to go through taking a &quot;vanilla&quot; MVC 3 app and enhancing it to work with Web Optimization. To start, follow these basic steps:</p><ol><li>Open Visual Studio (bet you didn&#x27;t see that coming!)</li><li>Create a new MVC 3 application (I called mine &quot;WebOptimizationWithMvc3&quot; to demonstrate my imaginative flair). It doesn&#x27;t really matter which sort of MVC 3 project you create - I chose an Intranet application but really that&#x27;s by the by.</li><li>Update pre-existing NuGet packages</li><li>At the NuGet console type: &quot;<code>Install-Package Microsoft.AspNet.Web.Optimization</code>&quot;</li></ol><p>Whilst the NuGet package adds the necessary references to your MVC 3 project it doesn&#x27;t add the corresponding namespaces to the web.configs. To fix this manually add the following child XML element to the <code>&amp;lt;namespaces&amp;gt;</code> element in your root and Views web.config files:</p><p><code>&amp;lt;add namespace=&quot;System.Web.Optimization&quot; /&amp;gt;</code></p><p>This gives you access to <code>Scripts</code> and <code>Styles</code> in your views without needing the fully qualified namespace. For reasons best known to Microsoft I had to close down and restart Visual Studio before intellisense started working. You may need to do likewise.</p><p>Next up we want to get some JavaScript / CSS bundles in place. To do this, create a folder in the root of your project called &quot;App_Start&quot;. There&#x27;s nothing magical about this to my knowledge; this is just a convention that&#x27;s been adopted to store all the bits of startup in one place and avoid clutterage. (I think this grew out of Nuget; see <a href="http://blog.davidebbo.com/2011/02/appstart-folder-convention-for-nuget.html" target="_blank" rel="noopener noreferrer">David Ebbo talking about this here</a>.) Inside your new folder you should add a new class called <code>BundleConfig.cs</code> which looks like this:</p><script src="https://gist.github.com/3839486.js?file=BundleConfig.cs"></script><p>The above is what you get when you create a new MVC 4 project (as it includes Web Optimization out of the box). All it does is create some JavaScript and CSS bundles relating to jQuery, jQuery UI, jQuery Validate, Modernizr and the standard site CSS. Nothing radical here but this example should give you an idea of how bundling can be configured and used. To make use of <code>BundleConfig.cs</code> you should modify your <code>Global.asax.cs</code> so it looks like this:</p><script src="https://gist.github.com/3839486.js?file=Global.asax.cs"></script><p>Once you&#x27;ve done this you&#x27;re ready to start using Web Optimization in your MVC 3 application.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="switching-over-_layoutcshtml-to-use-web-optimization"></a>Switching over _Layout.cshtml to use Web Optimization<a class="hash-link" href="#switching-over-_layoutcshtml-to-use-web-optimization" title="Direct link to heading">#</a></h2><p>With a &quot;vanilla&quot; MVC 3 app the only use of CSS and JavaScript files is found in <code>_Layout.cshtml</code>. To switch over to using Web Optimization you should replace the existing <code>_Layout.cshtml</code> with this: (you&#x27;ll see that the few differences that there are between the 2 are solely around the replacement of link / script tags with references to <code>Scripts</code> and <code>Styles</code> instead)</p><script src="https://gist.github.com/3839486.js?file=_Layout.cshtml"></script><p>Do note that in the above <code>Scripts.Render</code> call we&#x27;re rendering out 3 bundles; jQuery, jQuery UI and jQuery Validate. We&#x27;re not using any of these in <code>_Layout.cshtml</code> but rendering these (and their associated link tags) gives us a chance to demonstrate that everything is working as expected.</p><p>In your root web.config file make sure that the following tag is in place: <code>&amp;lt;compilation debug=&quot;&lt;b&gt;true&lt;/b&gt;&quot; targetFramework=&quot;4.0&quot;&amp;gt;</code>. Then run, the generated HTML should look something like this:</p><script src="https://gist.github.com/3839486.js?file=debug  true"></script><p>This demonstrates that when the application has debug set to true you see the full scripts / links being rendered out as you would hope (to make your debugging less painful).</p><p>Now go back to your root <code>web.config</code> file and chance the debug tag to false: <code>&amp;lt;compilation debug=&quot;&lt;b&gt;false&lt;/b&gt;&quot; targetFramework=&quot;4.0&quot;&amp;gt;</code>. This time when you run, the generated HTML should look something like this:</p><script src="https://gist.github.com/3839486.js?file=debug  false"></script><p>This time you can see that in non-debug mode (ie how it would run in Production) minified bundles of scripts and css files are being served up instead of the raw files. And that&#x27;s it; done.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/asp-net">asp.net</a><a class="margin-horiz--sm" href="/tags/bundling">Bundling</a><a class="margin-horiz--sm" href="/tags/mvc-3">MVC 3</a><a class="margin-horiz--sm" href="/tags/web-optimization">Web Optimization</a><a class="margin-horiz--sm" href="/tags/minification">Minification</a></div></footer></article><div><a href="https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/blog/2012-10-05-using-web-optimization-with-mvc-3.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/2012/10/22/mvc-3-meet-dictionary"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« MVC 3 meet Dictionary</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/2012/10/03/unit-testing-and-entity-framework-filth"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Unit Testing and Entity Framework: The Filth and the Fury Â»</div></a></div></nav></div></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-the-basics-in-place" class="table-of-contents__link">Getting the Basics in Place</a></li><li><a href="#switching-over-_layoutcshtml-to-use-web-optimization" class="table-of-contents__link">Switching over _Layout.cshtml to use Web Optimization</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Support me</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.buymeacoffee.com/qUBm0Wh" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;"></a></li><li class="footer__item"><div style="display: flex; align-items: center;"><iframe src="https://github.com/sponsors/johnnyreilly/button" title="Sponsor johnnyreilly" height="35" width="116" style="border: 0;"></iframe><div>&nbsp;on GitHub</div></div></li></ul></div><div class="col footer__col"><h4 class="footer__title">Feeds</h4><ul class="footer__items"><li class="footer__item"><a href="https://blog.johnnyreilly.com/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">RSS</a></li><li class="footer__item"><a href="https://blog.johnnyreilly.com/atom.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">Atom</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/styles.29bd7c80.js"></script>
<script src="/assets/js/runtime~main.82d802bb.js"></script>
<script src="/assets/js/main.c527f95b.js"></script>
<script src="/assets/js/1.c330b6a7.js"></script>
<script src="/assets/js/2.9dac0846.js"></script>
<script src="/assets/js/ccc49370.86a8a52f.js"></script>
<script src="/assets/js/c3b5bd8c.dd098e6e.js"></script>
<script src="/assets/js/8890ac7a.85d30348.js"></script>
<script src="/assets/js/fe3d2add.408ead11.js"></script>
</body>
</html>